##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    05/Jul/2008  20:08:34 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\Pasha\elf\_MY_PROJECT_\naticq_mod\status_change.c #
#    Command line    =  D:\Pasha\elf\_MY_PROJECT_\naticq_mod\status_change.c #
#                        -D NEWSGOLD -D ELKA -D UIN_WRITE --preprocess       #
#                       D:\Pasha\elf\_MY_PROJECT_\naticq_mod\Release_ELKA\Li #
#                       st\ -lC D:\Pasha\elf\_MY_PROJECT_\naticq_mod\Release #
#                       _ELKA\List\ -o D:\Pasha\elf\_MY_PROJECT_\naticq_mod\ #
#                       Release_ELKA\Obj\ -s9 --no_unroll --cpu_mode arm     #
#                       --endian little --cpu ARM926EJ-S --stack_align 4     #
#                       --interwork -e --fpu None --dlib_config              #
#                       "D:\Pasha\Embedded Workbench 4.0                     #
#                       Evaluation2\ARM\LIB\dl5tpainl8n.h" -I                #
#                       "D:\Pasha\Embedded Workbench 4.0                     #
#                       Evaluation2\ARM\INC\" --inline_threshold=2           #
#    List file       =  D:\Pasha\elf\_MY_PROJECT_\naticq_mod\Release_ELKA\Li #
#                       st\status_change.lst                                 #
#    Object file     =  D:\Pasha\elf\_MY_PROJECT_\naticq_mod\Release_ELKA\Ob #
#                       j\status_change.r79                                  #
#                                                                            #
#                                                                            #
##############################################################################

D:\Pasha\elf\_MY_PROJECT_\naticq_mod\status_change.c
      1          /*
      2            Интерфейс и функции смены своего статуса
      3          */
      4          #include "../inc/swilib.h"
      5          #include "../inc/cfg_items.h"
      6          #include "../inc/pnglist.h"
      7          #include "NatICQ.h"
      8          #include "main.h"
      9          #include "status_change.h"
     10          #include "strings.h"
     11          #include "language.h"
     12          
     13          //===============================================================================================
     14          // ELKA Compatibility
     15          #pragma inline
     16          static void patch_header(const HEADER_DESC* head)
     17          {
     18            ((HEADER_DESC *)head)->rc.x=0;
     19            ((HEADER_DESC *)head)->rc.y=YDISP;
     20            ((HEADER_DESC *)head)->rc.x2=ScreenW()-1;
     21            ((HEADER_DESC *)head)->rc.y2=HeaderH()-1+YDISP;
     22          }
     23          #pragma inline
     24          void patch_input(const INPUTDIA_DESC* inp)
     25          {
     26            ((INPUTDIA_DESC *)inp)->rc.x = 0;
     27            ((INPUTDIA_DESC *)inp)->rc.y = HeaderH() + 1 + YDISP;
     28            ((INPUTDIA_DESC *)inp)->rc.x2=ScreenW() - 1;
     29            ((INPUTDIA_DESC *)inp)->rc.y2=ScreenH() - SoftkeyH() - 1;
     30          }
     31          //===============================================================================================
     32          
     33          extern char TEMPLATES_PATH[];

   \                                 In segment DATA_C, align 4, align-sorted
     34          static const char XS_FILE_NAME[]="\\XStatuses.txt";
   \                     XS_FILE_NAME:
   \   00000000   5C5853746174       DC8 "\\XStatuses.txt"
   \              757365732E74
   \              787400      
   \   0000000F   00                 DC8 0
     35          
     36          

   \                                 In segment DATA_Z, align 4, align-sorted
     37          char *XStatusText;
   \                     XStatusText:
   \   00000000                      DS8 4
     38          
     39          extern int CurrentStatus;
     40          extern int CurrentXStatus;
     41          extern  int S_ICONS[];
     42          #ifdef NEWSGOLD
     43          extern void SetIconBarHandler();
     44          #endif
     45          
     46          extern int isAutoStatusOn;    
     47          extern int msg_away_timer;
     48          extern void away_timer();
     49          extern int away_m;
     50          extern unsigned int AUTO_ENGADE;
     51             
     52          #pragma inline
     53          static void Change_Status(int status)
     54          {
     55            CurrentStatus=status;
     56            set_my_status();
     57          #ifdef NEWSGOLD
     58            SetIconBarHandler();
     59          #endif
     60          
     61            if(isAutoStatusOn!=12 && isAutoStatusOn==status)
     62            {
     63              msg_away_timer=(AUTO_ENGADE*12);
     64              away_m=1;
     65              away_timer();
     66            }
     67            else if(status==IS_ONLINE || status==IS_FFC || status== IS_HOME)
     68            {
     69              msg_away_timer=0;
     70              away_m=0;
     71            }
     72            
     73            SUBPROC((void*)WriteDefSettings);
     74          }
     75          
     76          #pragma inline
     77          static void Change_XStatus(int xstatus)
     78          {
     79            CurrentXStatus=xstatus;
     80            set_my_xstatus();
     81          #ifdef NEWSGOLD
     82            SetIconBarHandler();
     83          #endif
     84            SUBPROC((void*)WriteDefSettings);
     85          }
     86          
     87          ///////////////////////////////////////////////////////////////////////////////
     88          #pragma inline
     89          static unsigned int GetStatusIndexInMenu(unsigned int status)
     90          {
     91            switch(status)
     92            {
     93            case IS_ONLINE: {return 0;}
     94            case IS_AWAY: {return 1;}
     95            case IS_NA: {return 2;}
     96            case IS_DND: {return 3;}
     97            case IS_OCCUPIED: {return 4;}
     98            case IS_FFC: {return 5;}
     99            case IS_INVISIBLE: {return 6;}
    100            case IS_DEPRESSION: return 7;
    101            case IS_EVIL: return 8;
    102            case IS_HOME: return 9;
    103            case IS_LUNCH: return 10;
    104            case IS_WORK: return 11;
    105            }
    106            return 0;
    107          }
    108          
    109          #pragma inline 
    110          static unsigned int GetStatusInMenuByPos(int pos)
    111          {
    112            switch(pos)
    113            {
    114            case 0:
    115              return IS_ONLINE;
    116            case 1:
    117              return IS_AWAY;
    118            case 2:
    119              return IS_NA;
    120            case 3:
    121              return IS_DND;
    122            case 4:
    123              return IS_OCCUPIED;
    124            case 5:
    125              return IS_FFC;
    126            case 6:
    127              return IS_INVISIBLE;
    128            case 7:
    129              return IS_DEPRESSION;
    130            case 8:
    131              return IS_EVIL;
    132            case 9:
    133              return IS_HOME;
    134            case 10:
    135              return IS_LUNCH;
    136            case 11:
    137              return IS_WORK;
    138            }
    139            return IS_UNKNOWN;
    140          }
    141          

   \                                 In segment CODE, align 4, keep-with-next
    142          static int st_onkey(void *data, GUI_MSG *msg)
    143          {
   \                     st_onkey:
   \   00000000   10402DE9           PUSH     {R4,LR}
    144            int i;
    145            if (msg->keys==0x18 || msg->keys==0x3D)
   \   00000004   F210D1E1           LDRSH    R1,[R1, #+2]
   \   00000008   180051E3           CMP      R1,#+24
   \   0000000C   3D005113           CMPNE    R1,#+61
   \   00000010   4000001A           BNE      ??st_onkey_1
    146            {
    147              i=GetCurMenuItem(data);
    148              Change_Status(GetStatusInMenuByPos(i));
   \   00000014   8F0100EF           SWI      +399
   \   00000018   0B0050E3           CMP      R0,#+11
   \   0000001C   1D00008A           BHI      ??st_onkey_2
   \   00000020   011F8FE2           ADR      R1,??st_onkey_0
   \   00000024   0010D1E7           LDRB     R1,[R1, R0]
   \   00000028   01F18FE0           ADD      PC,PC,R1, LSL #+2
   \                     ??st_onkey_0:
   \   0000002C   02040608           DC8      +2,+4,+6,+8
   \   00000030   0A0C0E10           DC8      +10,+12,+14,+16
   \   00000034   12141618           DC8      +18,+20,+22,+24
   \                     ??st_onkey_3:
   \   00000038   0B40A0E3           MOV      R4,#+11
   \   0000003C   160000EA           B        ??st_onkey_4
   \                     ??st_onkey_5:
   \   00000040   0240A0E3           MOV      R4,#+2
   \   00000044   140000EA           B        ??st_onkey_4
   \                     ??st_onkey_6:
   \   00000048   0340A0E3           MOV      R4,#+3
   \   0000004C   120000EA           B        ??st_onkey_4
   \                     ??st_onkey_7:
   \   00000050   0540A0E3           MOV      R4,#+5
   \   00000054   100000EA           B        ??st_onkey_4
   \                     ??st_onkey_8:
   \   00000058   0440A0E3           MOV      R4,#+4
   \   0000005C   0E0000EA           B        ??st_onkey_4
   \                     ??st_onkey_9:
   \   00000060   0C40A0E3           MOV      R4,#+12
   \   00000064   0C0000EA           B        ??st_onkey_4
   \                     ??st_onkey_10:
   \   00000068   0140A0E3           MOV      R4,#+1
   \   0000006C   0A0000EA           B        ??st_onkey_4
   \                     ??st_onkey_11:
   \   00000070   0640A0E3           MOV      R4,#+6
   \   00000074   080000EA           B        ??st_onkey_4
   \                     ??st_onkey_12:
   \   00000078   0740A0E3           MOV      R4,#+7
   \   0000007C   060000EA           B        ??st_onkey_4
   \                     ??st_onkey_13:
   \   00000080   0840A0E3           MOV      R4,#+8
   \   00000084   040000EA           B        ??st_onkey_4
   \                     ??st_onkey_14:
   \   00000088   0940A0E3           MOV      R4,#+9
   \   0000008C   020000EA           B        ??st_onkey_4
   \                     ??st_onkey_15:
   \   00000090   0A40A0E3           MOV      R4,#+10
   \   00000094   000000EA           B        ??st_onkey_4
   \                     ??st_onkey_2:
   \   00000098   0E40A0E3           MOV      R4,#+14
   \                     ??st_onkey_4:
   \   0000009C   ........           LDR      R0,??DataTable5  ;; CurrentStatus
   \   000000A0   004080E5           STR      R4,[R0, #+0]
   \   000000A4   ........           _BLF     set_my_status,??set_my_status??rA
   \   000000A8   ........           _BLF     SetIconBarHandler,??SetIconBarHandler??rA
   \   000000AC   6C009FE5           LDR      R0,??st_onkey_16  ;; isAutoStatusOn
   \   000000B0   6C109FE5           LDR      R1,??st_onkey_16+0x4  ;; away_m
   \   000000B4   000090E5           LDR      R0,[R0, #+0]
   \   000000B8   68209FE5           LDR      R2,??st_onkey_16+0x8  ;; msg_away_timer
   \   000000BC   0C0050E3           CMP      R0,#+12
   \   000000C0   0A00000A           BEQ      ??st_onkey_17
   \   000000C4   040050E1           CMP      R0,R4
   \   000000C8   0800001A           BNE      ??st_onkey_17
   \   000000CC   58009FE5           LDR      R0,??st_onkey_16+0xC  ;; AUTO_ENGADE
   \   000000D0   0C30A0E3           MOV      R3,#+12
   \   000000D4   000090E5           LDR      R0,[R0, #+0]
   \   000000D8   930000E0           MUL      R0,R3,R0
   \   000000DC   000082E5           STR      R0,[R2, #+0]
   \   000000E0   0100A0E3           MOV      R0,#+1
   \   000000E4   000081E5           STR      R0,[R1, #+0]
   \   000000E8   ........           _BLF     away_timer,??away_timer??rA
   \   000000EC   050000EA           B        ??st_onkey_18
   \                     ??st_onkey_17:
   \   000000F0   0B0054E3           CMP      R4,#+11
   \   000000F4   0C005413           CMPNE    R4,#+12
   \   000000F8   08005413           CMPNE    R4,#+8
   \   000000FC   0000A003           MOVEQ    R0,#+0
   \   00000100   00008205           STREQ    R0,[R2, #+0]
   \   00000104   00008105           STREQ    R0,[R1, #+0]
   \                     ??st_onkey_18:
   \   00000108   ........           LDR      R0,??DataTable8  ;; WriteDefSettings
   \   0000010C   710100EF           SWI      +369
    149              return (1);
   \   00000110   0100A0E3           MOV      R0,#+1
   \   00000114   1080BDE8           POP      {R4,PC}
    150            }
    151            return (0);
   \                     ??st_onkey_1:
   \   00000118   0000A0E3           MOV      R0,#+0
   \   0000011C   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??st_onkey_16:
   \   00000120   ........           DC32     isAutoStatusOn
   \   00000124   ........           DC32     away_m
   \   00000128   ........           DC32     msg_away_timer
   \   0000012C   ........           DC32     AUTO_ENGADE
    152          }
    153              
    154          ///////////////////////////////////////////////////////////////////////////////
    155          
    156          #define STATUSES_NUM 12
    157          

   \                                 In segment DATA_C, align 4, align-sorted
    158          static const char * const menutexts[STATUSES_NUM]=
   \                     menutexts:
   \   00000000   ........           DC32 `?<Constant "\\302 \\361\\345\\362\\350">`
   \   00000004   ........           DC32 `?<Constant "\\316\\362\\356\\370\\270\\353">`
   \   00000008   ........           DC32 `?<Constant "\\315\\345\\344\\356\\361\\362\\363\\357\\3`
   \   0000000C   ........           DC32 `?<Constant "\\315\\345 \\341\\345\\361\\357\\356\\352\\`
   \   00000010   ........           DC32 `?<Constant "\\307\\340\\355\\377\\362">`
   \   00000014   ........           DC32 `?<Constant "\\303\\356\\362\\356\\342 \\341\\356\\353\\`
   \   00000018   ........           DC32 `?<Constant "\\315\\345\\342\\350\\344\\350\\354\\373\\3`
   \   0000001C   ........           DC32 `?<Constant "\\304\\345\\357\\360\\345\\361\\361\\350\\3`
   \   00000020   ........           DC32 `?<Constant "\\307\\353\\356\\351">`
   \   00000024   ........           DC32 `?<Constant "\\304\\356\\354\\340">`
   \   00000028   ........           DC32 `?<Constant "\\306\\360\\363">`
   \   0000002C   ........           DC32 `?<Constant "\\315\\340 \\360\\340\\341\\356\\362\\345"`
    159          {
    160            LG_STONLINE,
    161            LG_STAWAY,
    162            LG_STNA,
    163            LG_STDND,
    164            LG_STOCCUP,
    165            LG_STFFC,
    166            LG_STINVIS,
    167            LG_STDEPRESSION,
    168            LG_STEVIL,
    169            LG_STHOME,
    170            LG_STLUNCH,
    171            LG_STWORK
    172          };
    173          

   \                                 In segment CODE, align 4, keep-with-next
    174          void st_icons_set(void *data, int curitem, void *unk)
    175          {
   \                     st_icons_set:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    176            WSHDR *ws;
    177            void *item=AllocMenuItem(data);
   \   0000000C   970100EF           SWI      +407
   \   00000010   0060A0E1           MOV      R6,R0
   \   00000014   D8009FE5           LDR      R0,??st_icons_set_1  ;; menutexts
   \   00000018   058190E7           LDR      R8,[R0, +R5, LSL #+2]
   \   0000001C   0800A0E1           MOV      R0,R8
    178            extern const char percent_t[];
    179            ws=AllocMenuWS(data,strlen(menutexts[curitem]));
   \   00000020   1B0000EF           SWI      +27
   \   00000024   0010A0E1           MOV      R1,R0
   \   00000028   0400A0E1           MOV      R0,R4
   \   0000002C   980100EF           SWI      +408
    180            wsprintf(ws,percent_t,menutexts[curitem]);
   \   00000030   ........           LDR      R1,??DataTable9  ;; percent_t
   \   00000034   0070A0E1           MOV      R7,R0
   \   00000038   0820A0E1           MOV      R2,R8
   \   0000003C   240100EF           SWI      +292
    181            SetMenuItemIconArray(data,item,S_ICONS+GetStatusInMenuByPos(curitem));
   \   00000040   0500A0E1           MOV      R0,R5
   \   00000044   0B0050E3           CMP      R0,#+11
   \   00000048   1D00008A           BHI      ??st_icons_set_2
   \   0000004C   011F8FE2           ADR      R1,??st_icons_set_0
   \   00000050   0010D1E7           LDRB     R1,[R1, R0]
   \   00000054   01F18FE0           ADD      PC,PC,R1, LSL #+2
   \                     ??st_icons_set_0:
   \   00000058   02040608           DC8      +2,+4,+6,+8
   \   0000005C   0A0C0E10           DC8      +10,+12,+14,+16
   \   00000060   12141618           DC8      +18,+20,+22,+24
   \                     ??st_icons_set_3:
   \   00000064   0B00A0E3           MOV      R0,#+11
   \   00000068   160000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_5:
   \   0000006C   0200A0E3           MOV      R0,#+2
   \   00000070   140000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_6:
   \   00000074   0300A0E3           MOV      R0,#+3
   \   00000078   120000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_7:
   \   0000007C   0500A0E3           MOV      R0,#+5
   \   00000080   100000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_8:
   \   00000084   0400A0E3           MOV      R0,#+4
   \   00000088   0E0000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_9:
   \   0000008C   0C00A0E3           MOV      R0,#+12
   \   00000090   0C0000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_10:
   \   00000094   0100A0E3           MOV      R0,#+1
   \   00000098   0A0000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_11:
   \   0000009C   0600A0E3           MOV      R0,#+6
   \   000000A0   080000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_12:
   \   000000A4   0700A0E3           MOV      R0,#+7
   \   000000A8   060000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_13:
   \   000000AC   0800A0E3           MOV      R0,#+8
   \   000000B0   040000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_14:
   \   000000B4   0900A0E3           MOV      R0,#+9
   \   000000B8   020000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_15:
   \   000000BC   0A00A0E3           MOV      R0,#+10
   \   000000C0   000000EA           B        ??st_icons_set_4
   \                     ??st_icons_set_2:
   \   000000C4   0E00A0E3           MOV      R0,#+14
   \                     ??st_icons_set_4:
   \   000000C8   ........           LDR      R1,??DataTable4  ;; S_ICONS
   \   000000CC   002181E0           ADD      R2,R1,R0, LSL #+2
   \   000000D0   0610A0E1           MOV      R1,R6
   \   000000D4   0400A0E1           MOV      R0,R4
   \   000000D8   990100EF           SWI      +409
    182            SetMenuItemText(data, item, ws, curitem);
   \   000000DC   0530A0E1           MOV      R3,R5
   \   000000E0   0720A0E1           MOV      R2,R7
   \   000000E4   0610A0E1           MOV      R1,R6
   \   000000E8   0400A0E1           MOV      R0,R4
   \   000000EC   9A0100EF           SWI      +410
    183          }
   \   000000F0   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??st_icons_set_1:
   \   000000F4   ........           DC32     menutexts
    184          
    185          static const HEADER_DESC st_menuhdr={0,0,0,0,NULL,(int)LG_CHGSTATUS,LGP_NULL};
    186          
    187          static const int st_menusoftkeys[]={0,1,2};
    188          
    189          static const SOFTKEY_DESC st_menu_sk[]=
    190          {
    191            {0x0018,0x0000,(int)LG_SELECT},
    192            {0x0001,0x0000,(int)LG_BACK},
    193            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    194          };
    195          
    196          static const SOFTKEYSTAB st_menu_skt=
    197          {
    198            st_menu_sk,0
    199          };
    200          

   \                                 In segment CODE, align 4, keep-with-next
    201          static void stmenu_ghook(void *data, int cmd)
    202          {
   \                     stmenu_ghook:
   \   00000000   00402DE9           PUSH     {LR}
    203            if (cmd==0x0A)
   \   00000004   0A0051E3           CMP      R1,#+10
   \   00000008   0080BD18           POPNE    {PC}
    204            {
    205              DisableIDLETMR();
   \   0000000C   7F0100EF           SWI      +383
    206            }
    207          }
   \   00000010   0080BDE8           POP      {PC}             ;; return

   \                                 In segment DATA_C, align 4, align-sorted
   \                     st_menuhdr:
   \   00000000   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000008   00000000....       DC32 0H, `?<Constant "\\321\\354\\345\\355\\350\\362\\374 \\361\\`
   \              ....        
   \   00000010   FFFFFF7F           DC32 2147483647
   \   00000014   08000000....       DC32 8, st_onkey, stmenu_ghook, 0H, st_menusoftkeys, st_menu_skt, 17
   \              ............
   \              00000000....
   \              ............
   \              11000000    
   \   00000030   ........0000       DC32 st_icons_set, 0H, 0H, 12
   \              000000000000
   \              0C000000    

   \                                 In segment DATA_C, align 4, align-sorted
   \                     st_menusoftkeys:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_C, align 4, align-sorted
   \                     st_menu_sk:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "\\302\\373\\341\\356\\360">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "\\315\\340\\347\\340\\344">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515

   \                                 In segment DATA_C, align 4, align-sorted
   \                     st_menu_skt:
   \   00000000   ........0000       DC32 st_menu_sk, 0
   \              0000        
    208          
    209          static const MENU_DESC st_tmenu=
    210          {
    211            8,st_onkey,stmenu_ghook,NULL,
    212            st_menusoftkeys,
    213            &st_menu_skt,
    214            0x11,//MENU_FLAG,
    215            st_icons_set,
    216            NULL,//st_menuitems,
    217            NULL,
    218            STATUSES_NUM
    219          };
    220          
    221          

   \                                 In segment CODE, align 4, keep-with-next
    222          void DispStatusChangeMenu()
    223          {
    224            *((int **)(&st_menuhdr.icon))=S_ICONS+CurrentStatus;
   \                     DispStatusChangeMenu:
   \   00000000   ........           LDR      R1,??DataTable4  ;; S_ICONS
   \   00000004   70402DE9           PUSH     {R4-R6,LR}
   \   00000008   E0409FE5           LDR      R4,??DispStatusChangeMenu_1  ;; st_menuhdr
   \   0000000C   ........           LDR      R5,??DataTable5  ;; CurrentStatus
    225            patch_header(&st_menuhdr);
   \   00000010   0060A0E3           MOV      R6,#+0
   \   00000014   000095E5           LDR      R0,[R5, #+0]
   \   00000018   B060C4E1           STRH     R6,[R4, #+0]
   \   0000001C   000181E0           ADD      R0,R1,R0, LSL #+2
   \   00000020   080084E5           STR      R0,[R4, #+8]
   \   00000024   1800A0E3           MOV      R0,#+24
   \   00000028   B200C4E1           STRH     R0,[R4, #+2]
   \   0000002C   888100EF           SWI      +33160
   \   00000030   010040E2           SUB      R0,R0,#+1
   \   00000034   B400C4E1           STRH     R0,[R4, #+4]
   \   00000038   8A8100EF           SWI      +33162
   \   0000003C   170080E2           ADD      R0,R0,#+23
   \   00000040   B600C4E1           STRH     R0,[R4, #+6]
    226            CreateMenu(0,0,&st_tmenu,&st_menuhdr,GetStatusIndexInMenu(CurrentStatus),STATUSES_NUM,0,0);
   \   00000044   000095E5           LDR      R0,[R5, #+0]
   \   00000048   010040E2           SUB      R0,R0,#+1
   \   0000004C   0B0050E3           CMP      R0,#+11
   \   00000050   1A00008A           BHI      ??DispStatusChangeMenu_2
   \   00000054   011F8FE2           ADR      R1,??DispStatusChangeMenu_0
   \   00000058   0010D1E7           LDRB     R1,[R1, R0]
   \   0000005C   01F18FE0           ADD      PC,PC,R1, LSL #+2
   \                     ??DispStatusChangeMenu_0:
   \   00000060   0C020408           DC8      +12,+2,+4,+8
   \   00000064   060E1012           DC8      +6,+14,+16,+18
   \   00000068   1416170A           DC8      +20,+22,+23,+10
   \                     ??DispStatusChangeMenu_3:
   \   0000006C   0160A0E3           MOV      R6,#+1
   \   00000070   120000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_4:
   \   00000074   0260A0E3           MOV      R6,#+2
   \   00000078   100000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_5:
   \   0000007C   0360A0E3           MOV      R6,#+3
   \   00000080   0E0000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_6:
   \   00000084   0460A0E3           MOV      R6,#+4
   \   00000088   0C0000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_7:
   \   0000008C   0560A0E3           MOV      R6,#+5
   \   00000090   0A0000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_8:
   \   00000094   0660A0E3           MOV      R6,#+6
   \   00000098   080000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_9:
   \   0000009C   0760A0E3           MOV      R6,#+7
   \   000000A0   060000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_10:
   \   000000A4   0860A0E3           MOV      R6,#+8
   \   000000A8   040000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_11:
   \   000000AC   0960A0E3           MOV      R6,#+9
   \   000000B0   020000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_12:
   \   000000B4   0A60A0E3           MOV      R6,#+10
   \   000000B8   000000EA           B        ??DispStatusChangeMenu_2
   \                     ??DispStatusChangeMenu_13:
   \   000000BC   0B60A0E3           MOV      R6,#+11
   \                     ??DispStatusChangeMenu_2:
   \   000000C0   0000A0E3           MOV      R0,#+0
   \   000000C4   01002DE9           PUSH     {R0}
   \   000000C8   01002DE9           PUSH     {R0}
   \   000000CC   0430A0E1           MOV      R3,R4
   \   000000D0   142084E2           ADD      R2,R4,#+20
   \   000000D4   0010A0E3           MOV      R1,#+0
   \   000000D8   0C00A0E3           MOV      R0,#+12
   \   000000DC   01002DE9           PUSH     {R0}
   \   000000E0   40002DE9           PUSH     {R6}
   \   000000E4   0000A0E3           MOV      R0,#+0
   \   000000E8   520100EF           SWI      +338
    227          }
   \   000000EC   7F80BDE8           POP      {R0-R6,PC}       ;; return
   \                     ??DispStatusChangeMenu_1:
   \   000000F0   ........           DC32     st_menuhdr
    228          
    229          //--------------------------------
    230          // XStatuses
    231          //--------------------------------
    232          extern DYNPNGICONLIST *XStatusesImgList;
    233          extern int *XStatusesIconArray;
    234          extern volatile int total_xstatuses;
    235          

   \                                 In segment DATA_I, align 4, align-sorted
    236          SOFTKEY_DESC edit_x_sk[]=
   \                     edit_x_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for edit_x_sk>`
    237          {
    238            {0x0018,0x0000,(int)"Save!"},
    239            {0x0001,0x0000,(int)""},
    240            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    241          };
    242          

   \                                 In segment DATA_I, align 4, align-sorted
    243          SOFTKEYSTAB edit_x_skt=
   \                     edit_x_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for edit_x_skt>`
    244          {
    245            edit_x_sk,0
    246          };
    247          

   \                                 In segment CODE, align 4, keep-with-next
    248          void edit_xstatus_locret(void){}
   \                     edit_xstatus_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
    249          

   \                                 In segment CODE, align 4, keep-with-next
    250          void ReplaceStr(char **str, int start_prev, int prev_len, char *next, int next_len)
    251          {
   \                     ReplaceStr:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   24809DE5           LDR      R8,[SP, #+36]
   \   00000008   0040A0E1           MOV      R4,R0
    252            char *d, *buf;
    253            char *s=*str;
   \   0000000C   009094E5           LDR      R9,[R4, #+0]
   \   00000010   0150A0E1           MOV      R5,R1
   \   00000014   0260A0E1           MOV      R6,R2
   \   00000018   0370A0E1           MOV      R7,R3
    254            if (s)
   \   0000001C   000059E3           CMP      R9,#+0
   \   00000020   F08FBD08           POPEQ    {R4-R11,PC}
    255            {
    256              d=buf=malloc(strlen(s)+next_len-prev_len+1);
   \   00000024   0900A0E1           MOV      R0,R9
   \   00000028   1B0000EF           SWI      +27
   \   0000002C   000088E0           ADD      R0,R8,R0
   \   00000030   060040E0           SUB      R0,R0,R6
   \   00000034   010080E2           ADD      R0,R0,#+1
   \   00000038   140000EF           SWI      +20
   \   0000003C   00B0A0E1           MOV      R11,R0
   \   00000040   0BA0A0E1           MOV      R10,R11
    257              if (start_prev)
   \   00000044   000055E3           CMP      R5,#+0
   \   00000048   0300000A           BEQ      ??ReplaceStr_0
    258              {
    259                memcpy(buf, s, start_prev);
   \   0000004C   0520A0E1           MOV      R2,R5
   \   00000050   0910A0E1           MOV      R1,R9
   \   00000054   1E0100EF           SWI      +286
    260                buf+=start_prev;
   \   00000058   0BB085E0           ADD      R11,R5,R11
    261              }
    262              if (next_len)
   \                     ??ReplaceStr_0:
   \   0000005C   000058E3           CMP      R8,#+0
   \   00000060   0400000A           BEQ      ??ReplaceStr_1
    263              {
    264                memcpy(buf,next,next_len);
   \   00000064   0820A0E1           MOV      R2,R8
   \   00000068   0710A0E1           MOV      R1,R7
   \   0000006C   0B00A0E1           MOV      R0,R11
   \   00000070   1E0100EF           SWI      +286
    265                buf+=next_len;
   \   00000074   0BB088E0           ADD      R11,R8,R11
    266              }
    267              strcpy(buf, s+start_prev+prev_len);
   \                     ??ReplaceStr_1:
   \   00000078   090085E0           ADD      R0,R5,R9
   \   0000007C   001086E0           ADD      R1,R6,R0
   \   00000080   0B00A0E1           MOV      R0,R11
   \   00000084   1A0000EF           SWI      +26
    268              mfree(s);
   \   00000088   0900A0E1           MOV      R0,R9
   \   0000008C   150000EF           SWI      +21
    269              *str=d;
   \   00000090   00A084E5           STR      R10,[R4, #+0]
    270            }
    271          }
   \   00000094   F08FBDE8           POP      {R4-R11,PC}      ;; return
    272          

   \                                 In segment CODE, align 4, keep-with-next
    273          int edit_xstatus_onkey(GUI *data, GUI_MSG *msg)
    274          {
   \                     edit_xstatus_onkey:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   B8D04DE2           SUB      SP,SP,#+184
   \   00000008   0040A0E1           MOV      R4,R0
    275            WSHDR *ws;
    276            char *s, *d, tmp[132];
    277            int cur_x_st;
    278            int len, l;
    279            int is_any_change=0;
    280            if (msg->keys==0xFFF)
   \   0000000C   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000010   0060A0E3           MOV      R6,#+0
   \   00000014   FF10A0E3           MOV      R1,#+255
   \   00000018   F01E81E3           ORR      R1,R1,#0xF00
   \   0000001C   010050E1           CMP      R0,R1
   \   00000020   9400001A           BNE      ??edit_xstatus_onkey_0
    281            {
    282              cur_x_st=(int)EDIT_GetUserPointer(data);
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   DF0100EF           SWI      +479
   \   0000002C   0050A0E1           MOV      R5,R0
    283              EDITCONTROL ec;
    284              ExtractEditControl(data,2,&ec);   // Комментарий
   \   00000030   08208DE2           ADD      R2,SP,#+8
   \   00000034   0210A0E3           MOV      R1,#+2
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   690100EF           SWI      +361
    285              ws=ec.pWS;
   \   00000040   30809DE5           LDR      R8,[SP, #+48]
    286              
    287              s=GetXStatusStr(cur_x_st*3,&len);
   \   00000044   851085E0           ADD      R1,R5,R5, LSL #+1
    288              d=tmp;
    289          
    290              if (s)
   \   00000048   ........           LDR      R5,??DataTable20  ;; XStatusText
   \   0000004C   04108DE5           STR      R1,[SP, #+4]
   \   00000050   04009DE5           LDR      R0,[SP, #+4]
   \   00000054   0D10A0E1           MOV      R1,SP
   \   00000058   ........           BL       GetXStatusStr
   \   0000005C   0090B0E1           MOVS     R9,R0
   \   00000060   34A08DE2           ADD      R10,SP,#+52
   \   00000064   2100000A           BEQ      ??edit_xstatus_onkey_1
    291              {
    292                l=ws->wsbody[0];
   \   00000068   000098E5           LDR      R0,[R8, #+0]
    293                for (int i=0; i<l; i++) 
   \   0000006C   00B0A0E3           MOV      R11,#+0
   \   00000070   B070D0E1           LDRH     R7,[R0, #+0]
   \   00000074   010057E3           CMP      R7,#+1
   \   00000078   060000AA           BGE      ??edit_xstatus_onkey_2
   \   0000007C   070000EA           B        ??edit_xstatus_onkey_3
    294                {
    295                  *d++=char16to8(ws->wsbody[i+1]);
   \                     ??edit_xstatus_onkey_4:
   \   00000080   000098E5           LDR      R0,[R8, #+0]
   \   00000084   8B0080E0           ADD      R0,R0,R11, LSL #+1
   \   00000088   B200D0E1           LDRH     R0,[R0, #+2]
    296                }
   \   0000008C   01B08BE2           ADD      R11,R11,#+1
   \   00000090   ........           _BLF     char16to8,??char16to8??rA
   \   00000094   ........           STRB     R0,[R10], #+1
   \                     ??edit_xstatus_onkey_2:
   \   00000098   07005BE1           CMP      R11,R7
   \   0000009C   F7FFFFBA           BLT      ??edit_xstatus_onkey_4
    297                *d=0;
   \                     ??edit_xstatus_onkey_3:
   \   000000A0   0000A0E3           MOV      R0,#+0
   \   000000A4   0000CAE5           STRB     R0,[R10, #+0]
    298                if (len!=l || strncmp(s,tmp,len))
   \   000000A8   00009DE5           LDR      R0,[SP, #+0]
   \   000000AC   070050E1           CMP      R0,R7
   \   000000B0   0500001A           BNE      ??edit_xstatus_onkey_5
   \   000000B4   0020A0E1           MOV      R2,R0
   \   000000B8   34108DE2           ADD      R1,SP,#+52
   \   000000BC   0900A0E1           MOV      R0,R9
   \   000000C0   150100EF           SWI      +277
   \   000000C4   000050E3           CMP      R0,#+0
   \   000000C8   0800000A           BEQ      ??edit_xstatus_onkey_1
    299                {
    300                  ReplaceStr(&XStatusText,s-XStatusText,len,tmp,l);
   \                     ??edit_xstatus_onkey_5:
   \   000000CC   80002DE9           PUSH     {R7}
   \   000000D0   000095E5           LDR      R0,[R5, #+0]
   \   000000D4   04209DE5           LDR      R2,[SP, #+4]
   \   000000D8   38308DE2           ADD      R3,SP,#+56
   \   000000DC   001049E0           SUB      R1,R9,R0
   \   000000E0   0500A0E1           MOV      R0,R5
   \   000000E4   ........           BL       ReplaceStr
    301                  is_any_change=1;
   \   000000E8   0160A0E3           MOV      R6,#+1
   \   000000EC   04D08DE2           ADD      SP,SP,#+4
    302                }
    303              }
    304          
    305              ExtractEditControl(data,4,&ec);   // Короткий икс статус
   \                     ??edit_xstatus_onkey_1:
   \   000000F0   08208DE2           ADD      R2,SP,#+8
   \   000000F4   0410A0E3           MOV      R1,#+4
   \   000000F8   0400A0E1           MOV      R0,R4
   \   000000FC   690100EF           SWI      +361
    306              ws=ec.pWS;
    307              
    308              s=GetXStatusStr(cur_x_st*3+1,&len);
   \   00000100   04009DE5           LDR      R0,[SP, #+4]
   \   00000104   30809DE5           LDR      R8,[SP, #+48]
   \   00000108   0D10A0E1           MOV      R1,SP
   \   0000010C   010080E2           ADD      R0,R0,#+1
   \   00000110   ........           BL       GetXStatusStr
   \   00000114   0090B0E1           MOVS     R9,R0
    309              d=tmp;
   \   00000118   34A08DE2           ADD      R10,SP,#+52
    310          
    311              if (s)
   \   0000011C   2100000A           BEQ      ??edit_xstatus_onkey_6
    312              {
    313                l=ws->wsbody[0];
   \   00000120   000098E5           LDR      R0,[R8, #+0]
    314                for (int i=0; i<l; i++) 
   \   00000124   00B0A0E3           MOV      R11,#+0
   \   00000128   B070D0E1           LDRH     R7,[R0, #+0]
   \   0000012C   010057E3           CMP      R7,#+1
   \   00000130   060000AA           BGE      ??edit_xstatus_onkey_7
   \   00000134   070000EA           B        ??edit_xstatus_onkey_8
    315                {
    316                  *d++=char16to8(ws->wsbody[i+1]);
   \                     ??edit_xstatus_onkey_9:
   \   00000138   000098E5           LDR      R0,[R8, #+0]
   \   0000013C   8B0080E0           ADD      R0,R0,R11, LSL #+1
   \   00000140   B200D0E1           LDRH     R0,[R0, #+2]
    317                }
   \   00000144   01B08BE2           ADD      R11,R11,#+1
   \   00000148   ........           _BLF     char16to8,??char16to8??rA
   \   0000014C   ........           STRB     R0,[R10], #+1
   \                     ??edit_xstatus_onkey_7:
   \   00000150   07005BE1           CMP      R11,R7
   \   00000154   F7FFFFBA           BLT      ??edit_xstatus_onkey_9
    318                *d=0;
   \                     ??edit_xstatus_onkey_8:
   \   00000158   0000A0E3           MOV      R0,#+0
   \   0000015C   0000CAE5           STRB     R0,[R10, #+0]
    319                if (len!=l || strncmp(s,tmp,len))
   \   00000160   00009DE5           LDR      R0,[SP, #+0]
   \   00000164   070050E1           CMP      R0,R7
   \   00000168   0500001A           BNE      ??edit_xstatus_onkey_10
   \   0000016C   0020A0E1           MOV      R2,R0
   \   00000170   34108DE2           ADD      R1,SP,#+52
   \   00000174   0900A0E1           MOV      R0,R9
   \   00000178   150100EF           SWI      +277
   \   0000017C   000050E3           CMP      R0,#+0
   \   00000180   0800000A           BEQ      ??edit_xstatus_onkey_6
    320                {
    321                  ReplaceStr(&XStatusText,s-XStatusText,len,tmp,l);
   \                     ??edit_xstatus_onkey_10:
   \   00000184   80002DE9           PUSH     {R7}
   \   00000188   000095E5           LDR      R0,[R5, #+0]
   \   0000018C   04209DE5           LDR      R2,[SP, #+4]
   \   00000190   38308DE2           ADD      R3,SP,#+56
   \   00000194   001049E0           SUB      R1,R9,R0
   \   00000198   0500A0E1           MOV      R0,R5
   \   0000019C   ........           BL       ReplaceStr
    322                  is_any_change=1;
   \   000001A0   0160A0E3           MOV      R6,#+1
   \   000001A4   04D08DE2           ADD      SP,SP,#+4
    323                }
    324              }
    325              
    326              ExtractEditControl(data,6,&ec);   // Длинный икс статус
   \                     ??edit_xstatus_onkey_6:
   \   000001A8   08208DE2           ADD      R2,SP,#+8
   \   000001AC   0610A0E3           MOV      R1,#+6
   \   000001B0   0400A0E1           MOV      R0,R4
   \   000001B4   690100EF           SWI      +361
    327              ws=ec.pWS;
    328              
    329              s=GetXStatusStr(cur_x_st*3+2,&len);
   \   000001B8   04009DE5           LDR      R0,[SP, #+4]
   \   000001BC   30409DE5           LDR      R4,[SP, #+48]
   \   000001C0   0D10A0E1           MOV      R1,SP
   \   000001C4   020080E2           ADD      R0,R0,#+2
   \   000001C8   ........           BL       GetXStatusStr
   \   000001CC   0080B0E1           MOVS     R8,R0
    330              d=tmp;
   \   000001D0   34908DE2           ADD      R9,SP,#+52
    331          
    332              if (s)
   \   000001D4   2100000A           BEQ      ??edit_xstatus_onkey_11
    333              {
    334                l=ws->wsbody[0];
   \   000001D8   000094E5           LDR      R0,[R4, #+0]
    335                for (int i=0; i<l; i++) 
   \   000001DC   00A0A0E3           MOV      R10,#+0
   \   000001E0   B070D0E1           LDRH     R7,[R0, #+0]
   \   000001E4   010057E3           CMP      R7,#+1
   \   000001E8   060000AA           BGE      ??edit_xstatus_onkey_12
   \   000001EC   070000EA           B        ??edit_xstatus_onkey_13
    336                {
    337                  *d++=char16to8(ws->wsbody[i+1]);
   \                     ??edit_xstatus_onkey_14:
   \   000001F0   000094E5           LDR      R0,[R4, #+0]
   \   000001F4   8A0080E0           ADD      R0,R0,R10, LSL #+1
   \   000001F8   B200D0E1           LDRH     R0,[R0, #+2]
    338                }
   \   000001FC   01A08AE2           ADD      R10,R10,#+1
   \   00000200   ........           _BLF     char16to8,??char16to8??rA
   \   00000204   ........           STRB     R0,[R9], #+1
   \                     ??edit_xstatus_onkey_12:
   \   00000208   07005AE1           CMP      R10,R7
   \   0000020C   F7FFFFBA           BLT      ??edit_xstatus_onkey_14
    339                *d=0;
   \                     ??edit_xstatus_onkey_13:
   \   00000210   0000A0E3           MOV      R0,#+0
   \   00000214   0000C9E5           STRB     R0,[R9, #+0]
    340                if (len!=l || strncmp(s,tmp,len))
   \   00000218   00009DE5           LDR      R0,[SP, #+0]
   \   0000021C   070050E1           CMP      R0,R7
   \   00000220   0500001A           BNE      ??edit_xstatus_onkey_15
   \   00000224   0020A0E1           MOV      R2,R0
   \   00000228   34108DE2           ADD      R1,SP,#+52
   \   0000022C   0800A0E1           MOV      R0,R8
   \   00000230   150100EF           SWI      +277
   \   00000234   000050E3           CMP      R0,#+0
   \   00000238   0800000A           BEQ      ??edit_xstatus_onkey_11
    341                {
    342                  ReplaceStr(&XStatusText,s-XStatusText,len,tmp,l);
   \                     ??edit_xstatus_onkey_15:
   \   0000023C   80002DE9           PUSH     {R7}
   \   00000240   000095E5           LDR      R0,[R5, #+0]
   \   00000244   04209DE5           LDR      R2,[SP, #+4]
   \   00000248   38308DE2           ADD      R3,SP,#+56
   \   0000024C   001048E0           SUB      R1,R8,R0
   \   00000250   0500A0E1           MOV      R0,R5
   \   00000254   ........           BL       ReplaceStr
    343                  is_any_change=1;
   \   00000258   04D08DE2           ADD      SP,SP,#+4
   \   0000025C   010000EA           B        ??edit_xstatus_onkey_16
    344                }
    345              }
    346              
    347              if (is_any_change)
   \                     ??edit_xstatus_onkey_11:
   \   00000260   000056E3           CMP      R6,#+0
   \   00000264   0000000A           BEQ      ??edit_xstatus_onkey_17
    348              {
    349                SaveXStatusText();
   \                     ??edit_xstatus_onkey_16:
   \   00000268   ........           BL       SaveXStatusText
    350              }
    351              return (1);
   \                     ??edit_xstatus_onkey_17:
   \   0000026C   0100A0E3           MOV      R0,#+1
   \   00000270   B8D08DE2           ADD      SP,SP,#+184
   \   00000274   F08FBDE8           POP      {R4-R11,PC}
    352            }
    353            return (0);
   \                     ??edit_xstatus_onkey_0:
   \   00000278   0000A0E3           MOV      R0,#+0
   \   0000027C   B8D08DE2           ADD      SP,SP,#+184
   \   00000280   F08FBDE8           POP      {R4-R11,PC}      ;; return
    354          }
    355          

   \                                 In segment CODE, align 4, keep-with-next
    356          void edit_xstatus_ghook(GUI *data, int cmd)
    357          {
   \                     edit_xstatus_ghook:
   \   00000000   00402DE9           PUSH     {LR}
    358            static SOFTKEY_DESC sk={0x0FFF,0x0000,(int)"Save!"};
    359            if (cmd==0x0A)
   \   00000004   0A0051E3           CMP      R1,#+10
   \   00000008   0100001A           BNE      ??edit_xstatus_ghook_0
    360            {
    361              DisableIDLETMR();
   \   0000000C   7F0100EF           SWI      +383
   \   00000010   0080BDE8           POP      {PC}
    362            }
    363            if (cmd==7)
   \                     ??edit_xstatus_ghook_0:
   \   00000014   070051E3           CMP      R1,#+7
   \   00000018   0080BD18           POPNE    {PC}
    364            {
    365              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000001C   08109FE5           LDR      R1,??edit_xstatus_ghook_1  ;; ??sk
   \   00000020   0020A0E3           MOV      R2,#+0
   \   00000024   680100EF           SWI      +360
    366            }
    367          }
   \   00000028   0080BDE8           POP      {PC}             ;; return
   \                     ??edit_xstatus_ghook_1:
   \   0000002C   ........           DC32     ??sk

   \                                 In segment DATA_I, align 4, align-sorted
   \                     ??sk:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for sk>`
    368          

   \                                 In segment DATA_I, align 4, align-sorted
    369          HEADER_DESC edit_xstatus_hdr={0,0,0,0,NULL,(int)"X-Статус",LGP_NULL};
    370          
    371          INPUTDIA_DESC edit_xstatus_desc =
   \                     edit_xstatus_desc:
   \   00000000                      DS8 56
   \   00000038                      REQUIRE `?<Initializer for edit_xstatus_desc>`
   \                     edit_xstatus_hdr:
   \   00000038                      DS8 20
   \   0000004C                      REQUIRE `?<Initializer for edit_xstatus_hdr>`
    372          {
    373            1,
    374            edit_xstatus_onkey,
    375            edit_xstatus_ghook,
    376            (void *)edit_xstatus_locret,
    377            0,
    378            &edit_x_skt,
    379            {0,0,0,0},
    380            FONT_SMALL,
    381            100,
    382            101,
    383            0,
    384            //  0x00000001 - Выровнять по правому краю
    385            //  0x00000002 - Выровнять по центру
    386            //  0x00000004 - Инверсия знакомест
    387            //  0x00000008 - UnderLine
    388            //  0x00000020 - Не переносить слова
    389            //  0x00000200 - bold
    390            0,
    391            //  0x00000002 - ReadOnly
    392            //  0x00000004 - Не двигается курсор
    393            //  0x40000000 - Поменять местами софт-кнопки
    394            0x40000000
    395          };
    396          
    397          

   \                                 In segment CODE, align 4, keep-with-next
    398          static void EditXStatus(int xstatus)
    399          {
   \                     EditXStatus:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
    400            void *ma=malloc_adr();
    401            void *eq;
    402            EDITCONTROL ec;
    403            char *s;
    404            int len;
    405            int c;
    406             
    407            eq=AllocEQueue(ma,mfree_adr());    
    408            WSHDR *ews=AllocWS(128);
    409            ascii2ws(ews,"Комментарий:");   // Коментарий
   \   00000004   24839FE5           LDR      R8,??EditXStatus_0  ;; `?<Constant "\\312\\356\\354\\354\\345\\355\\362\\340\\3`
   \   00000008   30D04DE2           SUB      SP,SP,#+48
   \   0000000C   0040A0E1           MOV      R4,R0
   \   00000010   148000EF           SWI      +32788
   \   00000014   0050A0E1           MOV      R5,R0
   \   00000018   158000EF           SWI      +32789
   \   0000001C   0010A0E1           MOV      R1,R0
   \   00000020   0500A0E1           MOV      R0,R5
   \   00000024   630100EF           SWI      +355
   \   00000028   0060A0E1           MOV      R6,R0
   \   0000002C   8000A0E3           MOV      R0,#+128
   \   00000030   250100EF           SWI      +293
   \   00000034   0070A0E1           MOV      R7,R0
   \   00000038   0810A0E1           MOV      R1,R8
   \   0000003C   ........           _BLF     ascii2ws,??ascii2ws??rA
    410            PrepareEditControl(&ec);
   \   00000040   04008DE2           ADD      R0,SP,#+4
   \   00000044   640100EF           SWI      +356
    411            ConstructEditControl(&ec,ECT_HEADER,0x40,ews,ews->wsbody[0]);
   \   00000048   000097E5           LDR      R0,[R7, #+0]
   \   0000004C   0730A0E1           MOV      R3,R7
   \   00000050   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000054   4020A0E3           MOV      R2,#+64
   \   00000058   0110A0E3           MOV      R1,#+1
   \   0000005C   01002DE9           PUSH     {R0}
    412            AddEditControlToEditQend(eq,&ec,ma);    //1
    413            
    414            CutWSTR(ews,0);
    415            s=GetXStatusStr(xstatus*3, &len);
   \   00000060   849084E0           ADD      R9,R4,R4, LSL #+1
   \   00000064   08008DE2           ADD      R0,SP,#+8
   \   00000068   650100EF           SWI      +357
   \   0000006C   0520A0E1           MOV      R2,R5
   \   00000070   08108DE2           ADD      R1,SP,#+8
   \   00000074   0600A0E1           MOV      R0,R6
   \   00000078   660100EF           SWI      +358
   \   0000007C   0010A0E3           MOV      R1,#+0
   \   00000080   0700A0E1           MOV      R0,R7
   \   00000084   260100EF           SWI      +294
   \   00000088   04108DE2           ADD      R1,SP,#+4
   \   0000008C   0900A0E1           MOV      R0,R9
   \   00000090   ........           BL       GetXStatusStr
   \   00000094   00A0B0E1           MOVS     R10,R0
    416            if (s)
   \   00000098   04D08DE2           ADD      SP,SP,#+4
   \   0000009C   0C00000A           BEQ      ??EditXStatus_1
   \   000000A0   060000EA           B        ??EditXStatus_2
    417            {
    418              while((c=*s++) && len)
    419              {
    420                wsAppendChar(ews,char8to16(c));
   \                     ??EditXStatus_3:
   \   000000A4   ........           _BLF     char8to16,??char8to16??rA
   \   000000A8   0010A0E1           MOV      R1,R0
   \   000000AC   0700A0E1           MOV      R0,R7
   \   000000B0   1C0000EF           SWI      +28
    421                len--;
   \   000000B4   00109DE5           LDR      R1,[SP, #+0]
   \   000000B8   011041E2           SUB      R1,R1,#+1
   \   000000BC   00108DE5           STR      R1,[SP, #+0]
    422              }
   \                     ??EditXStatus_2:
   \   000000C0   ........           LDRB     R0,[R10], #+1
   \   000000C4   000050E3           CMP      R0,#+0
   \   000000C8   00109D15           LDRNE    R1,[SP, #+0]
   \   000000CC   00005113           CMPNE    R1,#+0
   \   000000D0   F3FFFF1A           BNE      ??EditXStatus_3
    423            }
    424            PrepareEditControl(&ec);
   \                     ??EditXStatus_1:
   \   000000D4   04008DE2           ADD      R0,SP,#+4
   \   000000D8   640100EF           SWI      +356
    425            ConstructEditControl(&ec,ECT_NORMAL_TEXT,0x40,ews,20);
   \   000000DC   1400A0E3           MOV      R0,#+20
   \   000000E0   01002DE9           PUSH     {R0}
   \   000000E4   0730A0E1           MOV      R3,R7
   \   000000E8   4020A0E3           MOV      R2,#+64
   \   000000EC   0310A0E3           MOV      R1,#+3
   \   000000F0   08008DE2           ADD      R0,SP,#+8
   \   000000F4   650100EF           SWI      +357
    426            AddEditControlToEditQend(eq,&ec,ma);   //2
   \   000000F8   0520A0E1           MOV      R2,R5
   \   000000FC   08108DE2           ADD      R1,SP,#+8
   \   00000100   0600A0E1           MOV      R0,R6
   \   00000104   660100EF           SWI      +358
    427            
    428            ascii2ws(ews,"Short X:");      // Короткий Икс Статус
   \   00000108   101088E2           ADD      R1,R8,#+16
   \   0000010C   0700A0E1           MOV      R0,R7
   \   00000110   ........           _BLF     ascii2ws,??ascii2ws??rA
    429            PrepareEditControl(&ec);
   \   00000114   08008DE2           ADD      R0,SP,#+8
   \   00000118   640100EF           SWI      +356
    430            ConstructEditControl(&ec,ECT_HEADER,0x40,ews,ews->wsbody[0]);
   \   0000011C   000097E5           LDR      R0,[R7, #+0]
   \   00000120   0730A0E1           MOV      R3,R7
   \   00000124   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000128   4020A0E3           MOV      R2,#+64
   \   0000012C   0110A0E3           MOV      R1,#+1
   \   00000130   01002DE9           PUSH     {R0}
   \   00000134   0C008DE2           ADD      R0,SP,#+12
   \   00000138   650100EF           SWI      +357
    431            AddEditControlToEditQend(eq,&ec,ma);   //3
   \   0000013C   0520A0E1           MOV      R2,R5
   \   00000140   0C108DE2           ADD      R1,SP,#+12
   \   00000144   0600A0E1           MOV      R0,R6
   \   00000148   660100EF           SWI      +358
    432            
    433            CutWSTR(ews,0);
   \   0000014C   0010A0E3           MOV      R1,#+0
   \   00000150   0700A0E1           MOV      R0,R7
   \   00000154   260100EF           SWI      +294
    434            s=GetXStatusStr(xstatus*3+1, &len);
   \   00000158   08108DE2           ADD      R1,SP,#+8
   \   0000015C   010089E2           ADD      R0,R9,#+1
   \   00000160   ........           BL       GetXStatusStr
   \   00000164   00A0B0E1           MOVS     R10,R0
    435            if (s)
   \   00000168   08D08DE2           ADD      SP,SP,#+8
   \   0000016C   0C00000A           BEQ      ??EditXStatus_4
   \   00000170   060000EA           B        ??EditXStatus_5
    436            {
    437              while((c=*s++) && len)
    438              {
    439                wsAppendChar(ews,char8to16(c));
   \                     ??EditXStatus_6:
   \   00000174   ........           _BLF     char8to16,??char8to16??rA
   \   00000178   0010A0E1           MOV      R1,R0
   \   0000017C   0700A0E1           MOV      R0,R7
   \   00000180   1C0000EF           SWI      +28
    440                len--;
   \   00000184   00109DE5           LDR      R1,[SP, #+0]
   \   00000188   011041E2           SUB      R1,R1,#+1
   \   0000018C   00108DE5           STR      R1,[SP, #+0]
    441              }
   \                     ??EditXStatus_5:
   \   00000190   ........           LDRB     R0,[R10], #+1
   \   00000194   000050E3           CMP      R0,#+0
   \   00000198   00109D15           LDRNE    R1,[SP, #+0]
   \   0000019C   00005113           CMPNE    R1,#+0
   \   000001A0   F3FFFF1A           BNE      ??EditXStatus_6
    442            }
    443            PrepareEditControl(&ec);
   \                     ??EditXStatus_4:
   \   000001A4   04008DE2           ADD      R0,SP,#+4
   \   000001A8   640100EF           SWI      +356
    444            ConstructEditControl(&ec,ECT_NORMAL_TEXT,0x40,ews,128);
   \   000001AC   8000A0E3           MOV      R0,#+128
   \   000001B0   01002DE9           PUSH     {R0}
   \   000001B4   0730A0E1           MOV      R3,R7
   \   000001B8   4020A0E3           MOV      R2,#+64
   \   000001BC   0310A0E3           MOV      R1,#+3
   \   000001C0   08008DE2           ADD      R0,SP,#+8
   \   000001C4   650100EF           SWI      +357
    445            AddEditControlToEditQend(eq,&ec,ma);   //4
   \   000001C8   0520A0E1           MOV      R2,R5
   \   000001CC   08108DE2           ADD      R1,SP,#+8
   \   000001D0   0600A0E1           MOV      R0,R6
   \   000001D4   660100EF           SWI      +358
    446            
    447            ascii2ws(ews,"Large X:");     // Длинный Икс Статус
   \   000001D8   1C1088E2           ADD      R1,R8,#+28
   \   000001DC   0700A0E1           MOV      R0,R7
   \   000001E0   ........           _BLF     ascii2ws,??ascii2ws??rA
    448            PrepareEditControl(&ec);
   \   000001E4   08008DE2           ADD      R0,SP,#+8
   \   000001E8   640100EF           SWI      +356
    449            ConstructEditControl(&ec,ECT_HEADER,0x40,ews,ews->wsbody[0]);
   \   000001EC   000097E5           LDR      R0,[R7, #+0]
   \   000001F0   0730A0E1           MOV      R3,R7
   \   000001F4   B000D0E1           LDRH     R0,[R0, #+0]
   \   000001F8   4020A0E3           MOV      R2,#+64
   \   000001FC   0110A0E3           MOV      R1,#+1
   \   00000200   01002DE9           PUSH     {R0}
   \   00000204   0C008DE2           ADD      R0,SP,#+12
   \   00000208   650100EF           SWI      +357
    450            AddEditControlToEditQend(eq,&ec,ma);   //5
   \   0000020C   0520A0E1           MOV      R2,R5
   \   00000210   0C108DE2           ADD      R1,SP,#+12
   \   00000214   0600A0E1           MOV      R0,R6
   \   00000218   660100EF           SWI      +358
    451            
    452            CutWSTR(ews,0);
   \   0000021C   0010A0E3           MOV      R1,#+0
   \   00000220   0700A0E1           MOV      R0,R7
   \   00000224   260100EF           SWI      +294
    453            s=GetXStatusStr(xstatus*3+2, &len);
   \   00000228   08108DE2           ADD      R1,SP,#+8
   \   0000022C   020089E2           ADD      R0,R9,#+2
   \   00000230   ........           BL       GetXStatusStr
   \   00000234   0080B0E1           MOVS     R8,R0
    454            if (s)
   \   00000238   08D08DE2           ADD      SP,SP,#+8
   \   0000023C   0C00000A           BEQ      ??EditXStatus_7
   \   00000240   060000EA           B        ??EditXStatus_8
    455            {
    456              while((c=*s++) && len)
    457              {
    458                wsAppendChar(ews,char8to16(c));
   \                     ??EditXStatus_9:
   \   00000244   ........           _BLF     char8to16,??char8to16??rA
   \   00000248   0010A0E1           MOV      R1,R0
   \   0000024C   0700A0E1           MOV      R0,R7
   \   00000250   1C0000EF           SWI      +28
    459                len--;
   \   00000254   00109DE5           LDR      R1,[SP, #+0]
   \   00000258   011041E2           SUB      R1,R1,#+1
   \   0000025C   00108DE5           STR      R1,[SP, #+0]
    460              }
   \                     ??EditXStatus_8:
   \   00000260   ........           LDRB     R0,[R8], #+1
   \   00000264   000050E3           CMP      R0,#+0
   \   00000268   00109D15           LDRNE    R1,[SP, #+0]
   \   0000026C   00005113           CMPNE    R1,#+0
   \   00000270   F3FFFF1A           BNE      ??EditXStatus_9
    461            }
    462            PrepareEditControl(&ec);
   \                     ??EditXStatus_7:
   \   00000274   04008DE2           ADD      R0,SP,#+4
   \   00000278   640100EF           SWI      +356
    463            ConstructEditControl(&ec,ECT_NORMAL_TEXT,0x40,ews,128);
   \   0000027C   8000A0E3           MOV      R0,#+128
   \   00000280   01002DE9           PUSH     {R0}
   \   00000284   0730A0E1           MOV      R3,R7
   \   00000288   4020A0E3           MOV      R2,#+64
   \   0000028C   0310A0E3           MOV      R1,#+3
   \   00000290   08008DE2           ADD      R0,SP,#+8
   \   00000294   650100EF           SWI      +357
    464            AddEditControlToEditQend(eq,&ec,ma);   //6
   \   00000298   0520A0E1           MOV      R2,R5
    465            
    466            FreeWS(ews);
    467            patch_header(&edit_xstatus_hdr);
   \   0000029C   90509FE5           LDR      R5,??EditXStatus_0+0x4  ;; edit_xstatus_desc
   \   000002A0   08108DE2           ADD      R1,SP,#+8
   \   000002A4   0600A0E1           MOV      R0,R6
   \   000002A8   660100EF           SWI      +358
   \   000002AC   0700A0E1           MOV      R0,R7
   \   000002B0   290100EF           SWI      +297
   \   000002B4   0070A0E3           MOV      R7,#+0
   \   000002B8   B873C5E1           STRH     R7,[R5, #+56]
   \   000002BC   1800A0E3           MOV      R0,#+24
   \   000002C0   BA03C5E1           STRH     R0,[R5, #+58]
   \   000002C4   888100EF           SWI      +33160
   \   000002C8   010040E2           SUB      R0,R0,#+1
   \   000002CC   BC03C5E1           STRH     R0,[R5, #+60]
   \   000002D0   8A8100EF           SWI      +33162
   \   000002D4   170080E2           ADD      R0,R0,#+23
   \   000002D8   BE03C5E1           STRH     R0,[R5, #+62]
    468            patch_input(&edit_xstatus_desc);
   \   000002DC   B871C5E1           STRH     R7,[R5, #+24]
   \   000002E0   8A8100EF           SWI      +33162
   \   000002E4   190080E2           ADD      R0,R0,#+25
   \   000002E8   BA01C5E1           STRH     R0,[R5, #+26]
   \   000002EC   888100EF           SWI      +33160
   \   000002F0   010040E2           SUB      R0,R0,#+1
   \   000002F4   BC01C5E1           STRH     R0,[R5, #+28]
   \   000002F8   898100EF           SWI      +33161
   \   000002FC   0070A0E1           MOV      R7,R0
   \   00000300   8B8100EF           SWI      +33163
   \   00000304   000047E0           SUB      R0,R7,R0
   \   00000308   010040E2           SUB      R0,R0,#+1
   \   0000030C   BE01C5E1           STRH     R0,[R5, #+30]
    469            CreateInputTextDialog(&edit_xstatus_desc,&edit_xstatus_hdr,eq,1,(void *)xstatus);  
   \   00000310   10002DE9           PUSH     {R4}
   \   00000314   0130A0E3           MOV      R3,#+1
   \   00000318   0620A0E1           MOV      R2,R6
   \   0000031C   381085E2           ADD      R1,R5,#+56
   \   00000320   0500A0E1           MOV      R0,R5
   \   00000324   670100EF           SWI      +359
    470          }
   \   00000328   38D08DE2           ADD      SP,SP,#+56
   \   0000032C   F087BDE8           POP      {R4-R10,PC}      ;; return
   \                     ??EditXStatus_0:
   \   00000330   ........           DC32     `?<Constant "\\312\\356\\354\\354\\345\\355\\362\\340\\3`
   \   00000334   ........           DC32     edit_xstatus_desc
    471          
    472          extern int ind_set_xstatus;
    473          extern int Is_Vibra_Enabled;
    474          extern int Is_Id3tag_Enabled;
    475          extern unsigned int Is_Sounds_Enabled;
    476          extern int Is_Show_Offline;
    477          extern int Is_Show_Groups;    
    478          #ifdef ELKA
    479          extern int Is_SLI_On;//мигаем светодиодом
    480          #endif    
    481          extern int Is_SMARTCPU_On;//Вывод сообщений на гэ
    482          extern int Is_INC_On;//Popup message
    483          extern int Is_ILU_On;//Режим подсветки
    484          extern int Is_Double_Vibra_On;//Режим напоминания
    485          extern DEF_SETTINGS2 def_set[];
    486          extern int Is_PING_On;
    487          extern int Is_UPTIME_On;
    488          extern int Show_XTX;
    489          
    490              

   \                                 In segment CODE, align 4, keep-with-next
    491          static int xst_onkey(void *data, GUI_MSG *msg)
    492          {
   \                     xst_onkey:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0140A0E1           MOV      R4,R1
    493            int i;
    494            i=GetCurMenuItem(data);
   \   00000008   8F0100EF           SWI      +399
   \   0000000C   0050A0E1           MOV      R5,R0
    495            if (msg->keys==0x18)
   \   00000010   F200D4E1           LDRSH    R0,[R4, #+2]
   \   00000014   180050E3           CMP      R0,#+24
   \   00000018   0300001A           BNE      ??xst_onkey_0
    496            {
    497              EditXStatus(i);
   \   0000001C   0500A0E1           MOV      R0,R5
   \   00000020   ........           BL       EditXStatus
    498              return(0);
   \   00000024   0000A0E3           MOV      R0,#+0
   \   00000028   3080BDE8           POP      {R4,R5,PC}
    499            }
    500            if (msg->keys==0x3D)
   \                     ??xst_onkey_0:
   \   0000002C   3D0050E3           CMP      R0,#+61
   \   00000030   3B00001A           BNE      ??xst_onkey_1
    501            {
    502            
    503              Change_XStatus(i);
   \   00000034   ........           LDR      R0,??DataTable12  ;; CurrentXStatus
   \   00000038   005080E5           STR      R5,[R0, #+0]
   \   0000003C   ........           _BLF     set_my_xstatus,??set_my_xstatus??rA
   \   00000040   ........           _BLF     SetIconBarHandler,??SetIconBarHandler??rA
   \   00000044   ........           LDR      R0,??DataTable8  ;; WriteDefSettings
   \   00000048   710100EF           SWI      +369
    504          if(ind_set_xstatus)
   \   0000004C   D8009FE5           LDR      R0,??xst_onkey_2  ;; ind_set_xstatus
   \   00000050   000090E5           LDR      R0,[R0, #+0]
   \   00000054   000050E3           CMP      R0,#+0
   \   00000058   2F00000A           BEQ      ??xst_onkey_3
    505          {
    506              Is_Vibra_Enabled=def_set[i].vibra_status;
   \   0000005C   CC009FE5           LDR      R0,??xst_onkey_2+0x4  ;; def_set
   \   00000060   0B10A0E3           MOV      R1,#+11
   \   00000064   910520E0           MLA      R0,R1,R5,R0
   \   00000068   C4109FE5           LDR      R1,??xst_onkey_2+0x8  ;; Is_Vibra_Enabled
   \   0000006C   0020D0E5           LDRB     R2,[R0, #+0]
   \   00000070   012002E2           AND      R2,R2,#0x1
   \   00000074   002081E5           STR      R2,[R1, #+0]
    507          #ifdef NEWSGOLD
    508              Is_Id3tag_Enabled=def_set[i].Id3tag_status;
   \   00000078   0920D0E5           LDRB     R2,[R0, #+9]
   \   0000007C   B4109FE5           LDR      R1,??xst_onkey_2+0xC  ;; Is_Id3tag_Enabled
   \   00000080   002081E5           STR      R2,[R1, #+0]
    509          #endif
    510              Is_Sounds_Enabled=def_set[i].sound_status;
   \   00000084   0020D0E5           LDRB     R2,[R0, #+0]
   \   00000088   AC109FE5           LDR      R1,??xst_onkey_2+0x10  ;; Is_Sounds_Enabled
   \   0000008C   022002E2           AND      R2,R2,#0x2
   \   00000090   A220A0E1           LSR      R2,R2,#+1
   \   00000094   002081E5           STR      R2,[R1, #+0]
    511          #ifdef ELKA
    512              Is_SLI_On=def_set[i].sli_state;
   \   00000098   0320D0E5           LDRB     R2,[R0, #+3]
   \   0000009C   9C109FE5           LDR      R1,??xst_onkey_2+0x14  ;; Is_SLI_On
   \   000000A0   012002E2           AND      R2,R2,#0x1
   \   000000A4   002081E5           STR      R2,[R1, #+0]
    513          #endif
    514              Is_SMARTCPU_On=def_set[i].smartcpu_state;
   \   000000A8   0420D0E5           LDRB     R2,[R0, #+4]
   \   000000AC   90109FE5           LDR      R1,??xst_onkey_2+0x18  ;; Is_SMARTCPU_On
   \   000000B0   002081E5           STR      R2,[R1, #+0]
    515              Is_INC_On=def_set[i].inc_state;
   \   000000B4   0510D0E5           LDRB     R1,[R0, #+5]
   \   000000B8   88209FE5           LDR      R2,??xst_onkey_2+0x1C  ;; Is_INC_On
   \   000000BC   013001E2           AND      R3,R1,#0x1
   \   000000C0   003082E5           STR      R3,[R2, #+0]
    516              Is_ILU_On=def_set[i].ilu_state;
   \   000000C4   80209FE5           LDR      R2,??xst_onkey_2+0x20  ;; Is_ILU_On
   \   000000C8   021001E2           AND      R1,R1,#0x2
   \   000000CC   A110A0E1           LSR      R1,R1,#+1
   \   000000D0   001082E5           STR      R1,[R2, #+0]
    517              Is_PING_On=def_set[i].ping_state;
   \   000000D4   0720D0E5           LDRB     R2,[R0, #+7]
   \   000000D8   70109FE5           LDR      R1,??xst_onkey_2+0x24  ;; Is_PING_On
   \   000000DC   002081E5           STR      R2,[R1, #+0]
    518              Is_UPTIME_On=def_set[i].uptime_state;
   \   000000E0   0820D0E5           LDRB     R2,[R0, #+8]
   \   000000E4   68109FE5           LDR      R1,??xst_onkey_2+0x28  ;; Is_UPTIME_On
   \   000000E8   002081E5           STR      R2,[R1, #+0]
    519              Is_Show_Offline=def_set[i].off_contacts;
   \   000000EC   0120D0E5           LDRB     R2,[R0, #+1]
   \   000000F0   60109FE5           LDR      R1,??xst_onkey_2+0x2C  ;; Is_Show_Offline
   \   000000F4   002081E5           STR      R2,[R1, #+0]
    520              Is_Show_Groups=def_set[i].show_groups;
   \   000000F8   0220D0E5           LDRB     R2,[R0, #+2]
   \   000000FC   58109FE5           LDR      R1,??xst_onkey_2+0x30  ;; Is_Show_Groups
   \   00000100   002081E5           STR      R2,[R1, #+0]
    521              Is_Double_Vibra_On=def_set[i].remind_state;
   \   00000104   0620D0E5           LDRB     R2,[R0, #+6]
   \   00000108   50109FE5           LDR      R1,??xst_onkey_2+0x34  ;; Is_Double_Vibra_On
   \   0000010C   002081E5           STR      R2,[R1, #+0]
    522              Show_XTX=def_set[i].isXTX;//Показывать хстатус или время он лайн 
   \   00000110   0A00D0E5           LDRB     R0,[R0, #+10]
   \   00000114   48109FE5           LDR      R1,??xst_onkey_2+0x38  ;; Show_XTX
   \   00000118   000081E5           STR      R0,[R1, #+0]
    523          }
    524              return(1);
   \                     ??xst_onkey_3:
   \   0000011C   0100A0E3           MOV      R0,#+1
   \   00000120   3080BDE8           POP      {R4,R5,PC}
    525            }
    526            return (0);
   \                     ??xst_onkey_1:
   \   00000124   0000A0E3           MOV      R0,#+0
   \   00000128   3080BDE8           POP      {R4,R5,PC}       ;; return
   \                     ??xst_onkey_2:
   \   0000012C   ........           DC32     ind_set_xstatus
   \   00000130   ........           DC32     def_set
   \   00000134   ........           DC32     Is_Vibra_Enabled
   \   00000138   ........           DC32     Is_Id3tag_Enabled
   \   0000013C   ........           DC32     Is_Sounds_Enabled
   \   00000140   ........           DC32     Is_SLI_On
   \   00000144   ........           DC32     Is_SMARTCPU_On
   \   00000148   ........           DC32     Is_INC_On
   \   0000014C   ........           DC32     Is_ILU_On
   \   00000150   ........           DC32     Is_PING_On
   \   00000154   ........           DC32     Is_UPTIME_On
   \   00000158   ........           DC32     Is_Show_Offline
   \   0000015C   ........           DC32     Is_Show_Groups
   \   00000160   ........           DC32     Is_Double_Vibra_On
   \   00000164   ........           DC32     Show_XTX
    527          }
    528          

   \                                 In segment CODE, align 4, keep-with-next
    529          static void xst_ghook(void *data, int cmd)
    530          {
   \                     xst_ghook:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0140A0E1           MOV      R4,R1
    531            PNGTOP_DESC *pltop=PNG_TOP();
   \   00000008   B98100EF           SWI      +33209
    532            if (cmd==9)
   \   0000000C   090054E3           CMP      R4,#+9
    533            {
    534              pltop->dyn_pltop=NULL;
   \   00000010   0010A003           MOVEQ    R1,#+0
   \   00000014   08108005           STREQ    R1,[R0, #+8]
   \   00000018   1080BD08           POPEQ    {R4,PC}
    535            }
    536            if (cmd==0x0A)
   \   0000001C   0A0054E3           CMP      R4,#+10
   \   00000020   1080BD18           POPNE    {R4,PC}
    537            {
    538              pltop->dyn_pltop=XStatusesImgList;
   \   00000024   10109FE5           LDR      R1,??xst_ghook_0  ;; XStatusesImgList
   \   00000028   001091E5           LDR      R1,[R1, #+0]
   \   0000002C   081080E5           STR      R1,[R0, #+8]
    539              DisableIDLETMR();
   \   00000030   7F0100EF           SWI      +383
    540              //Загрузка текста при фокусе
    541              LoadXStatusText();
   \   00000034   ........           BL       LoadXStatusText
    542            }
    543          }
   \   00000038   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??xst_ghook_0:
   \   0000003C   ........           DC32     XStatusesImgList
    544          

   \                                 In segment CODE, align 4, keep-with-next
    545          static void xst_itemh(void *data, int curitem, void *unk)
    546          {
   \                     xst_itemh:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
    547            void *item=AllocMLMenuItem(data);
    548            WSHDR ws1loc, *ws1, *ws2;
    549            unsigned short num[128];
    550            WSHDR ws3loc, *ws3, *ws4;
    551            unsigned short num3[128];
    552            char ss[128];
    553            char *s;
    554            int l;
    555            extern const char percent_t[];
    556            
    557            ws1=CreateLocalWS(&ws1loc,num,128);
    558            ws3=CreateLocalWS(&ws3loc,num3,128);
    559            
    560            if (s=GetXStatusStr(curitem*3+1,&l))
   \   00000004   ........           LDR      R9,??DataTable9  ;; percent_t
   \   00000008   70A19FE5           LDR      R10,??xst_itemh_0  ;; `?<Constant "Short XS %d">`
   \   0000000C   ACDF4DE2           SUB      SP,SP,#+688
   \   00000010   0040A0E1           MOV      R4,R0
   \   00000014   0150A0E1           MOV      R5,R1
   \   00000018   190200EF           SWI      +537
   \   0000001C   0060A0E1           MOV      R6,R0
   \   00000020   8020A0E3           MOV      R2,#+128
   \   00000024   08108DE2           ADD      R1,SP,#+8
   \   00000028   A20F8DE2           ADD      R0,SP,#+648
   \   0000002C   270100EF           SWI      +295
   \   00000030   0070A0E1           MOV      R7,R0
   \   00000034   8020A0E3           MOV      R2,#+128
   \   00000038   421F8DE2           ADD      R1,SP,#+264
   \   0000003C   A70F8DE2           ADD      R0,SP,#+668
   \   00000040   270100EF           SWI      +295
   \   00000044   0080A0E1           MOV      R8,R0
   \   00000048   85B085E0           ADD      R11,R5,R5, LSL #+1
   \   0000004C   0D10A0E1           MOV      R1,SP
   \   00000050   01008BE2           ADD      R0,R11,#+1
   \   00000054   ........           BL       GetXStatusStr
   \   00000058   04008DE5           STR      R0,[SP, #+4]
   \   0000005C   000050E3           CMP      R0,#+0
   \   00000060   0E00000A           BEQ      ??xst_itemh_1
    561            {
    562              memset(ss,0,128);
   \   00000064   8020A0E3           MOV      R2,#+128
   \   00000068   0010A0E3           MOV      R1,#+0
   \   0000006C   820F8DE2           ADD      R0,SP,#+520
   \   00000070   BB0000EF           SWI      +187
    563              if (l>127) l=127;
   \   00000074   00009DE5           LDR      R0,[SP, #+0]
   \   00000078   800050E3           CMP      R0,#+128
   \   0000007C   7F10A0A3           MOVGE    R1,#+127
   \   00000080   00108DA5           STRGE    R1,[SP, #+0]
    564              strncpy(ss,s,l);
   \   00000084   00209DE5           LDR      R2,[SP, #+0]
   \   00000088   04109DE5           LDR      R1,[SP, #+4]
   \   0000008C   820F8DE2           ADD      R0,SP,#+520
   \   00000090   160100EF           SWI      +278
    565              wsprintf(ws1,percent_t,ss);
   \   00000094   822F8DE2           ADD      R2,SP,#+520
   \   00000098   0910A0E1           MOV      R1,R9
   \   0000009C   010000EA           B        ??xst_itemh_2
    566            }
    567            else
    568            {
    569              wsprintf(ws1,"Short XS %d",curitem);
   \                     ??xst_itemh_1:
   \   000000A0   0520A0E1           MOV      R2,R5
   \   000000A4   0A10A0E1           MOV      R1,R10
   \                     ??xst_itemh_2:
   \   000000A8   0700A0E1           MOV      R0,R7
   \   000000AC   240100EF           SWI      +292
    570            }
    571            if (s=GetXStatusStr(curitem*3+2,&l))
   \   000000B0   0D10A0E1           MOV      R1,SP
   \   000000B4   02008BE2           ADD      R0,R11,#+2
   \   000000B8   ........           BL       GetXStatusStr
   \   000000BC   00B0B0E1           MOVS     R11,R0
   \   000000C0   0E00000A           BEQ      ??xst_itemh_3
    572            {
    573              memset(ss,0,128);
   \   000000C4   8020A0E3           MOV      R2,#+128
   \   000000C8   0010A0E3           MOV      R1,#+0
   \   000000CC   820F8DE2           ADD      R0,SP,#+520
   \   000000D0   BB0000EF           SWI      +187
    574              if (l>127) l=127;
   \   000000D4   00009DE5           LDR      R0,[SP, #+0]
   \   000000D8   800050E3           CMP      R0,#+128
   \   000000DC   7F10A0A3           MOVGE    R1,#+127
   \   000000E0   00108DA5           STRGE    R1,[SP, #+0]
    575              strncpy(ss,s,l);
   \   000000E4   00209DE5           LDR      R2,[SP, #+0]
   \   000000E8   0B10A0E1           MOV      R1,R11
   \   000000EC   820F8DE2           ADD      R0,SP,#+520
   \   000000F0   160100EF           SWI      +278
    576              wsprintf(ws3,percent_t,ss);
   \   000000F4   822F8DE2           ADD      R2,SP,#+520
   \   000000F8   0910A0E1           MOV      R1,R9
   \   000000FC   010000EA           B        ??xst_itemh_4
    577            }
    578            else
    579            {
    580              wsprintf(ws3,"Large XS %d",curitem);
   \                     ??xst_itemh_3:
   \   00000100   0520A0E1           MOV      R2,R5
   \   00000104   0C108AE2           ADD      R1,R10,#+12
   \                     ??xst_itemh_4:
   \   00000108   0800A0E1           MOV      R0,R8
   \   0000010C   240100EF           SWI      +292
    581            }
    582            ws2=AllocMenuWS(data,ws1->wsbody[0]);
   \   00000110   000097E5           LDR      R0,[R7, #+0]
   \   00000114   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000118   0400A0E1           MOV      R0,R4
   \   0000011C   980100EF           SWI      +408
   \   00000120   0090A0E1           MOV      R9,R0
    583          
    584            wstrcpy(ws2,ws1);
   \   00000124   0710A0E1           MOV      R1,R7
   \   00000128   1F0100EF           SWI      +287
    585            ws4=AllocMenuWS(data,ws3->wsbody[0]);
   \   0000012C   000098E5           LDR      R0,[R8, #+0]
   \   00000130   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000134   0400A0E1           MOV      R0,R4
   \   00000138   980100EF           SWI      +408
   \   0000013C   0070A0E1           MOV      R7,R0
    586            wstrcpy(ws4,ws3);
   \   00000140   0810A0E1           MOV      R1,R8
   \   00000144   1F0100EF           SWI      +287
    587            SetMenuItemIconArray(data, item, XStatusesIconArray+curitem);
   \   00000148   ........           LDR      R0,??DataTable11  ;; XStatusesIconArray
   \   0000014C   0610A0E1           MOV      R1,R6
   \   00000150   000090E5           LDR      R0,[R0, #+0]
   \   00000154   052180E0           ADD      R2,R0,R5, LSL #+2
   \   00000158   0400A0E1           MOV      R0,R4
   \   0000015C   990100EF           SWI      +409
    588            SetMLMenuItemText(data, item, ws2, ws4, curitem);
   \   00000160   20002DE9           PUSH     {R5}
   \   00000164   0730A0E1           MOV      R3,R7
   \   00000168   0920A0E1           MOV      R2,R9
   \   0000016C   0610A0E1           MOV      R1,R6
   \   00000170   0400A0E1           MOV      R0,R4
   \   00000174   180200EF           SWI      +536
    589          }
   \   00000178   ADDF8DE2           ADD      SP,SP,#+692
   \   0000017C   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??xst_itemh_0:
   \   00000180   ........           DC32     `?<Constant "Short XS %d">`
    590          

   \                                 In segment DATA_C, align 4, align-sorted
    591          static const SOFTKEY_DESC xst_menu_sk[]=
   \                     xst_menu_sk:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "\\322\\345\\352\\361\\362">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "\\315\\340\\347\\340\\344">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
    592          {
    593            {0x0018,0x0000,(int)LG_TEXT},
    594            {0x0001,0x0000,(int)LG_BACK},
    595            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    596          };
    597          

   \                                 In segment DATA_C, align 4, align-sorted
    598          static const SOFTKEYSTAB xst_menu_skt=
   \                     xst_menu_skt:
   \   00000000   ........0000       DC32 xst_menu_sk, 0
   \              0000        
    599          {
    600            xst_menu_sk,0
    601          };
    602          

   \                                 In segment DATA_C, align 4, align-sorted
    603          static const HEADER_DESC xst_menuhdr={0,0,0,0,NULL,(int)LG_CHGXSTATUS,LGP_NULL};
   \                     xst_menuhdr:
   \   00000000   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000008   00000000....       DC32 0H, `?<Constant "\\321\\354\\345\\355\\350\\362\\374 X-\\36`
   \              ....        
   \   00000010   FFFFFF7F           DC32 2147483647
   \   00000014   08000000....       DC32 8, xst_onkey, xst_ghook, 0H, st_menusoftkeys, xst_menu_skt, 17
   \              ............
   \              00000000....
   \              ............
   \              11000000    
   \   00000030   ........0000       DC32 xst_itemh, 0H, 0H, 0, 1
   \              000000000000
   \              000000000100
   \              0000        
    604          
    605          static const ML_MENU_DESC xst_menu=
    606          {
    607            8,xst_onkey,xst_ghook,NULL,
    608            st_menusoftkeys,
    609            &xst_menu_skt,
    610            0x11,
    611            xst_itemh,
    612            NULL,
    613            NULL,
    614            0,
    615            1
    616          };
    617          

   \                                 In segment CODE, align 4, keep-with-next
    618          void DispXStatusChangeMenu(void)
    619          {
   \                     DispXStatusChangeMenu:
   \   00000000   10402DE9           PUSH     {R4,LR}
    620            patch_header(&xst_menuhdr);
   \   00000004   64409FE5           LDR      R4,??DispXStatusChangeMenu_0  ;; xst_menuhdr
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   1800A0E3           MOV      R0,#+24
   \   00000014   B200C4E1           STRH     R0,[R4, #+2]
   \   00000018   888100EF           SWI      +33160
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   B400C4E1           STRH     R0,[R4, #+4]
   \   00000024   8A8100EF           SWI      +33162
    621            *((int **)(&xst_menuhdr.icon))=XStatusesIconArray+CurrentXStatus;
   \   00000028   ........           LDR      R1,??DataTable11  ;; XStatusesIconArray
   \   0000002C   170080E2           ADD      R0,R0,#+23
   \   00000030   001091E5           LDR      R1,[R1, #+0]
   \   00000034   B600C4E1           STRH     R0,[R4, #+6]
   \   00000038   ........           LDR      R0,??DataTable12  ;; CurrentXStatus
    622            CreateMultiLinesMenu(0,0,&xst_menu,&xst_menuhdr,CurrentXStatus,total_xstatuses);
   \   0000003C   0430A0E1           MOV      R3,R4
   \   00000040   000090E5           LDR      R0,[R0, #+0]
   \   00000044   142084E2           ADD      R2,R4,#+20
   \   00000048   001181E0           ADD      R1,R1,R0, LSL #+2
   \   0000004C   081084E5           STR      R1,[R4, #+8]
   \   00000050   1C109FE5           LDR      R1,??DispXStatusChangeMenu_0+0x4  ;; total_xstatuses
   \   00000054   001091E5           LDR      R1,[R1, #+0]
   \   00000058   02002DE9           PUSH     {R1}
   \   0000005C   01002DE9           PUSH     {R0}
   \   00000060   0010A0E3           MOV      R1,#+0
   \   00000064   0000A0E3           MOV      R0,#+0
   \   00000068   170200EF           SWI      +535
    623          }
   \   0000006C   1380BDE8           POP      {R0,R1,R4,PC}    ;; return
   \                     ??DispXStatusChangeMenu_0:
   \   00000070   ........           DC32     xst_menuhdr
   \   00000074   ........           DC32     total_xstatuses
    624          

   \                                 In segment CODE, align 4, keep-with-next
    625          void LoadXStatusText(void)
    626          {
   \                     LoadXStatusText:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   4BDF4DE2           SUB      SP,SP,#+300
    627            FSTATS stat;
    628            char fn[256];
    629            int f;
    630            unsigned int ul;
    631            int fsize;
    632            char *p, *s;
    633            int c;
    634            FreeXStatusText();
    635            strcpy(fn,TEMPLATES_PATH);
    636            strcat(fn,XS_FILE_NAME);
    637            if (GetFileStats(fn,&stat,&ul)==-1) return;
   \   00000008   0040E0E3           MVN      R4,#+0
   \   0000000C   ........           BL       FreeXStatusText
   \   00000010   ........           LDR      R1,??DataTable17  ;; TEMPLATES_PATH
   \   00000014   04008DE2           ADD      R0,SP,#+4
   \   00000018   1A0000EF           SWI      +26
   \   0000001C   ........           LDR      R1,??DataTable18  ;; XS_FILE_NAME
   \   00000020   04008DE2           ADD      R0,SP,#+4
   \   00000024   170000EF           SWI      +23
   \   00000028   0D20A0E1           MOV      R2,SP
   \   0000002C   411F8DE2           ADD      R1,SP,#+260
   \   00000030   04008DE2           ADD      R0,SP,#+4
   \   00000034   840000EF           SWI      +132
   \   00000038   040050E1           CMP      R0,R4
   \   0000003C   2A00000A           BEQ      ??LoadXStatusText_0
    638            if ((fsize=stat.size)<=0) return;
   \   00000040   08519DE5           LDR      R5,[SP, #+264]
   \   00000044   010055E3           CMP      R5,#+1
   \   00000048   270000BA           BLT      ??LoadXStatusText_0
    639            if ((f=fopen(fn,A_ReadOnly+A_BIN,P_READ,&ul))==-1) return;
   \   0000004C   0D30A0E1           MOV      R3,SP
   \   00000050   8020A0E3           MOV      R2,#+128
   \   00000054   801CA0E3           MOV      R1,#+32768
   \   00000058   04008DE2           ADD      R0,SP,#+4
   \   0000005C   0A0000EF           SWI      +10
   \   00000060   0060A0E1           MOV      R6,R0
   \   00000064   040056E1           CMP      R6,R4
   \   00000068   1F00000A           BEQ      ??LoadXStatusText_0
    640            p=XStatusText=malloc(fsize+2);
   \   0000006C   ........           LDR      R4,??DataTable20  ;; XStatusText
   \   00000070   020085E2           ADD      R0,R5,#+2
   \   00000074   140000EF           SWI      +20
   \   00000078   000084E5           STR      R0,[R4, #+0]
   \   0000007C   0040A0E1           MOV      R4,R0
    641            s=p+1;
   \   00000080   017084E2           ADD      R7,R4,#+1
    642            s[fread(f,s,fsize,&ul)]=0;
   \   00000084   0080A0E3           MOV      R8,#+0
   \   00000088   0D30A0E1           MOV      R3,SP
   \   0000008C   0520A0E1           MOV      R2,R5
   \   00000090   0710A0E1           MOV      R1,R7
   \   00000094   0600A0E1           MOV      R0,R6
   \   00000098   0B0000EF           SWI      +11
   \   0000009C   0780C0E7           STRB     R8,[R0, +R7]
    643            fclose(f,&ul);
   \   000000A0   0D10A0E1           MOV      R1,SP
   \   000000A4   0600A0E1           MOV      R0,R6
   \   000000A8   0D0000EF           SWI      +13
   \   000000AC   040000EA           B        ??LoadXStatusText_1
    644            while((c=*s++)!=0)
    645            {
    646              if (c==10)
    647              {
    648                c=13;
    649                if (*s==13) s++;   // пропускаем
    650              }
    651              else if (c==13)
   \                     ??LoadXStatusText_2:
   \   000000B0   0D0050E3           CMP      R0,#+13
   \   000000B4   0100001A           BNE      ??LoadXStatusText_3
    652              {
    653                if (*s==10) s++;  // пропускаем
   \   000000B8   0A0051E3           CMP      R1,#+10
   \                     ??LoadXStatusText_4:
   \   000000BC   01708702           ADDEQ    R7,R7,#+1
    654              }
    655              *p++=c;
   \                     ??LoadXStatusText_3:
   \   000000C0   ........           STRB     R0,[R4], #+1
   \                     ??LoadXStatusText_1:
   \   000000C4   ........           LDRB     R0,[R7], #+1
   \   000000C8   000050E3           CMP      R0,#+0
   \   000000CC   0500000A           BEQ      ??LoadXStatusText_5
   \   000000D0   0010D7E5           LDRB     R1,[R7, #+0]
   \   000000D4   0A0050E3           CMP      R0,#+10
   \   000000D8   F4FFFF1A           BNE      ??LoadXStatusText_2
   \   000000DC   0D00A0E3           MOV      R0,#+13
   \   000000E0   0D0051E3           CMP      R1,#+13
   \   000000E4   F4FFFFEA           B        ??LoadXStatusText_4
    656            }
    657            *p=0;
   \                     ??LoadXStatusText_5:
   \   000000E8   0080C4E5           STRB     R8,[R4, #+0]
    658          }
   \                     ??LoadXStatusText_0:
   \   000000EC   4BDF8DE2           ADD      SP,SP,#+300      ;; stack cleaning
   \   000000F0   F081BDE8           POP      {R4-R8,PC}       ;; return
    659          

   \                                 In segment CODE, align 4, keep-with-next
    660          void SaveXStatusText(void)
    661          {
   \                     SaveXStatusText:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
    662            int f;
    663            char fn[256];
    664            unsigned int ul;
    665            if (!XStatusText) return;
   \   00000004   ........           LDR      R4,??DataTable20  ;; XStatusText
   \   00000008   41DF4DE2           SUB      SP,SP,#+260
   \   0000000C   000094E5           LDR      R0,[R4, #+0]
   \   00000010   000050E3           CMP      R0,#+0
   \   00000014   1800000A           BEQ      ??SaveXStatusText_0
    666            strcpy(fn,TEMPLATES_PATH);
   \   00000018   ........           LDR      R1,??DataTable17  ;; TEMPLATES_PATH
   \   0000001C   04008DE2           ADD      R0,SP,#+4
   \   00000020   1A0000EF           SWI      +26
    667            strcat(fn,XS_FILE_NAME);
   \   00000024   ........           LDR      R1,??DataTable18  ;; XS_FILE_NAME
   \   00000028   04008DE2           ADD      R0,SP,#+4
   \   0000002C   170000EF           SWI      +23
    668            if ((f=fopen(fn,A_ReadWrite+A_Create+A_Truncate+A_BIN,P_READ+P_WRITE,&ul))==-1) return;
   \   00000030   0D30A0E1           MOV      R3,SP
   \   00000034   602FA0E3           MOV      R2,#+384
   \   00000038   0210A0E3           MOV      R1,#+2
   \   0000003C   831C81E3           ORR      R1,R1,#0x8300
   \   00000040   04008DE2           ADD      R0,SP,#+4
   \   00000044   0A0000EF           SWI      +10
   \   00000048   0050A0E1           MOV      R5,R0
   \   0000004C   010075E3           CMN      R5,#+1
   \   00000050   0900000A           BEQ      ??SaveXStatusText_0
    669            fwrite(f,XStatusText,strlen(XStatusText),&ul);
   \   00000054   000094E5           LDR      R0,[R4, #+0]
   \   00000058   1B0000EF           SWI      +27
   \   0000005C   001094E5           LDR      R1,[R4, #+0]
   \   00000060   0D30A0E1           MOV      R3,SP
   \   00000064   0020A0E1           MOV      R2,R0
   \   00000068   0500A0E1           MOV      R0,R5
   \   0000006C   0C0000EF           SWI      +12
    670            fclose(f,&ul);
   \   00000070   0D10A0E1           MOV      R1,SP
   \   00000074   0500A0E1           MOV      R0,R5
   \   00000078   0D0000EF           SWI      +13
    671          }
   \                     ??SaveXStatusText_0:
   \   0000007C   41DF8DE2           ADD      SP,SP,#+260      ;; stack cleaning
   \   00000080   3080BDE8           POP      {R4,R5,PC}       ;; return
    672          

   \                                 In segment CODE, align 4, keep-with-next
    673          void FreeXStatusText(void)
    674          {
   \                     FreeXStatusText:
   \   00000000   10402DE9           PUSH     {R4,LR}
    675            mfree(XStatusText);
   \   00000004   ........           LDR      R4,??DataTable20  ;; XStatusText
   \   00000008   000094E5           LDR      R0,[R4, #+0]
   \   0000000C   150000EF           SWI      +21
    676            XStatusText=NULL;
   \   00000010   0000A0E3           MOV      R0,#+0
   \   00000014   000084E5           STR      R0,[R4, #+0]
    677          }
   \   00000018   1080BDE8           POP      {R4,PC}          ;; return
    678          

   \                                 In segment CODE, align 4, keep-with-next
    679          char *GetXStatusStr(int n, int *len)
    680          {
    681            int l=0;
    682            int c;
    683            char *p=XStatusText;
   \                     GetXStatusStr:
   \   00000000   ........           LDR      R2,??DataTable20  ;; XStatusText
   \   00000004   0030A0E3           MOV      R3,#+0
   \   00000008   002092E5           LDR      R2,[R2, #+0]
    684            char *pp;
    685            if (len) *len=0;
   \   0000000C   000051E3           CMP      R1,#+0
   \   00000010   00C0A013           MOVNE    R12,#+0
   \   00000014   00C08115           STRNE    R12,[R1, #+0]
    686            if (!p) return p;
   \   00000018   000052E3           CMP      R2,#+0
   \   0000001C   0700001A           BNE      ??GetXStatusStr_0
   \                     ??GetXStatusStr_1:
   \   00000020   0000A0E3           MOV      R0,#+0
   \   00000024   1EFF2FE1           BX       LR
    687            while(n)
    688            {
    689              while((c=*p++)>=32);
   \                     ??GetXStatusStr_2:
   \   00000028   ........           LDRB     R12,[R2], #+1
   \   0000002C   20005CE3           CMP      R12,#+32
   \   00000030   FCFFFFAA           BGE      ??GetXStatusStr_2
    690              if (!c) return NULL;
   \   00000034   00005CE3           CMP      R12,#+0
   \   00000038   F8FFFF0A           BEQ      ??GetXStatusStr_1
    691              n--;
   \   0000003C   010040E2           SUB      R0,R0,#+1
    692            }
   \                     ??GetXStatusStr_0:
   \   00000040   000050E3           CMP      R0,#+0
   \   00000044   F7FFFF1A           BNE      ??GetXStatusStr_2
    693            pp=p;
   \   00000048   0200A0E1           MOV      R0,R2
   \   0000004C   000000EA           B        ??GetXStatusStr_3
    694            while((*pp++)>=32) l++;
   \                     ??GetXStatusStr_4:
   \   00000050   013083E2           ADD      R3,R3,#+1
   \                     ??GetXStatusStr_3:
   \   00000054   ........           LDRB     R12,[R0], #+1
   \   00000058   20005CE3           CMP      R12,#+32
   \   0000005C   FBFFFF2A           BCS      ??GetXStatusStr_4
    695            if (len) *len=l;
   \   00000060   000051E3           CMP      R1,#+0
   \   00000064   00308115           STRNE    R3,[R1, #+0]
    696            return p;
   \   00000068   0200A0E1           MOV      R0,R2
   \   0000006C   1EFF2FE1           BX       LR               ;; return
    697          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   ........           DC32     S_ICONS

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable5:
   \   00000000   ........           DC32     CurrentStatus

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable8:
   \   00000000   ........           DC32     WriteDefSettings

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable9:
   \   00000000   ........           DC32     percent_t

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable11:
   \   00000000   ........           DC32     XStatusesIconArray

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable12:
   \   00000000   ........           DC32     CurrentXStatus

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable17:
   \   00000000   ........           DC32     TEMPLATES_PATH

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable18:
   \   00000000   ........           DC32     XS_FILE_NAME

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable20:
   \   00000000   ........           DC32     XStatusText

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for edit_x_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Save!">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for edit_x_skt>`:
   \   00000000   ........0000       DC32 edit_x_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sk>`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   ........           DC32 `?<Constant "Save!">`

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for edit_xstatus_desc>`:
   \   00000000   01000000....       DC32 1, edit_xstatus_onkey, edit_xstatus_ghook, edit_xstatus_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 edit_x_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   \                     `?<Initializer for edit_xstatus_hdr>`:
   \   00000038   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000040   00000000....       DC32 0H, `?<Constant "X-\\321\\362\\340\\362\\363\\361">`, 2147483647
   \              ....FFFFFF7F

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\304\\356\\354\\340">`:
   \   00000000   C4EEECE000         DC8 "\304\356\354\340"
   \   00000005   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\306\\360\\363">`:
   \   00000000   C6F0F300           DC8 "\306\360\363"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\315\\340 \\360\\340\\341\\356\\362\\345"`:
   \   00000000   CDE020F0E0E1       DC8 "\315\340 \360\340\341\356\362\345"
   \              EEF2E500    
   \   0000000A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\321\\354\\345\\355\\350\\362\\374 \\361\\`:
   \   00000000   D1ECE5EDE8F2       DC8 "\321\354\345\355\350\362\374 \361\362\340\362\363\361"
   \              FC20F1F2E0F2
   \              F3F100      
   \   0000000F   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\302\\373\\341\\356\\360">`:
   \   00000000   C2FBE1EEF000       DC8 "\302\373\341\356\360"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\303\\356\\362\\356\\342 \\341\\356\\353\\`:
   \   00000000   C3EEF2EEE220       DC8 "\303\356\362\356\342 \341\356\353\362\340\362\374"
   \              E1EEEBF2E0F2
   \              FC00        
   \   0000000E   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\315\\340\\347\\340\\344">`:
   \   00000000   CDE0E7E0E400       DC8 "\315\340\347\340\344"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Save!">`:
   \   00000000   536176652100       DC8 "Save!"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "">`:
   \   00000000   00                 DC8 ""

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "X-\\321\\362\\340\\362\\363\\361">`:
   \   00000000   582DD1F2E0F2       DC8 "X-\321\362\340\362\363\361"
   \              F3F100      
   \   00000009   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\322\\345\\352\\361\\362">`:
   \   00000000   D2E5EAF1F200       DC8 "\322\345\352\361\362"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\321\\354\\345\\355\\350\\362\\374 X-\\36`:
   \   00000000   D1ECE5EDE8F2       DC8 "\321\354\345\355\350\362\374 X-\361\362\340\362\363\361"
   \              FC20582DF1F2
   \              E0F2F3F100  
   \   00000011   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\312\\356\\354\\354\\345\\355\\362\\340\\3`:
   \   00000000   CAEEECECE5ED       DC8 "\312\356\354\354\345\355\362\340\360\350\351:"
   \              F2E0F0E8E93A
   \              00          
   \   0000000D   000000             DC8 0, 0, 0
   \   00000010   53686F727420       DC8 "Short X:"
   \              583A00      
   \   00000019   000000             DC8 0, 0, 0
   \   0000001C   4C6172676520       DC8 "Large X:"
   \              583A00      
   \   00000025   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Short XS %d">`:
   \   00000000   53686F727420       DC8 "Short XS %d"
   \              585320256400
   \   0000000C   4C6172676520       DC8 "Large XS %d"
   \              585320256400

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\302 \\361\\345\\362\\350">`:
   \   00000000   C220F1E5F2E8       DC8 "\302 \361\345\362\350"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\316\\362\\356\\370\\270\\353">`:
   \   00000000   CEF2EEF8B8EB       DC8 "\316\362\356\370\270\353"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\315\\345\\344\\356\\361\\362\\363\\357\\3`:
   \   00000000   CDE5E4EEF1F2       DC8 "\315\345\344\356\361\362\363\357\345\355"
   \              F3EFE5ED00  
   \   0000000B   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\315\\345 \\341\\345\\361\\357\\356\\352\\`:
   \   00000000   CDE520E1E5F1       DC8 "\315\345 \341\345\361\357\356\352\356\350\362\374"
   \              EFEEEAEEE8F2
   \              FC00        
   \   0000000E   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\307\\340\\355\\377\\362">`:
   \   00000000   C7E0EDFFF200       DC8 "\307\340\355\377\362"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\315\\345\\342\\350\\344\\350\\354\\373\\3`:
   \   00000000   CDE5E2E8E4E8       DC8 "\315\345\342\350\344\350\354\373\351"
   \              ECFBE900    
   \   0000000A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\304\\345\\357\\360\\345\\361\\361\\350\\3`:
   \   00000000   C4E5EFF0E5F1       DC8 "\304\345\357\360\345\361\361\350\377"
   \              F1E8FF00    
   \   0000000A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\307\\353\\356\\351">`:
   \   00000000   C7EBEEE900         DC8 "\307\353\356\351"
   \   00000005   000000             DC8 0, 0, 0

   Maximum stack usage in bytes:

     Function              CSTACK
     --------              ------
     DispStatusChangeMenu     32
     DispXStatusChangeMenu    16
     EditXStatus              88
     FreeXStatusText           8
     GetXStatusStr             0
     LoadXStatusText         324
     ReplaceStr               36
     SaveXStatusText         272
     edit_xstatus_ghook        4
     edit_xstatus_locret       0
     edit_xstatus_onkey      224
     st_icons_set             24
     st_onkey                  8
     stmenu_ghook              4
     xst_ghook                 8
     xst_itemh               728
     xst_onkey                12


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     XS_FILE_NAME                     16
     XStatusText                       4
     st_onkey                        304
     menutexts                        48
     st_icons_set                    248
     stmenu_ghook                     20
     st_menuhdr                       64
     st_menusoftkeys                  12
     st_menu_sk                       24
     st_menu_skt                       8
     DispStatusChangeMenu            244
     edit_x_sk                        24
     edit_x_skt                        8
     edit_xstatus_locret               4
     ReplaceStr                      152
     edit_xstatus_onkey              644
     edit_xstatus_ghook               48
     sk                                8
     edit_xstatus_desc                76
     EditXStatus                     824
     xst_onkey                       360
     xst_ghook                        64
     xst_itemh                       388
     xst_menu_sk                      24
     xst_menu_skt                      8
     xst_menuhdr                      68
     DispXStatusChangeMenu           120
     LoadXStatusText                 244
     SaveXStatusText                 132
     FreeXStatusText                  28
     GetXStatusStr                   112
     ??DataTable4                      4
     ??DataTable5                      4
     ??DataTable8                      4
     ??DataTable9                      4
     ??DataTable11                     4
     ??DataTable12                     4
     ??DataTable17                     4
     ??DataTable18                     4
     ??DataTable20                     4
     ?<Initializer for edit_x_sk>     24
     ?<Initializer for edit_x_skt>     8
     ?<Initializer for sk>             8
     ?<Initializer for edit_xstatus_desc>
                                      76
     ?<Constant "\304\356\354\340">    8
     ?<Constant "\306\360\363">        4
     ?<Constant "\315\340 \360\340\341\356\362\345"
                                      12
     ?<Constant "\321\354\345\355\350\362\374 \361\
                                      16
     ?<Constant "\302\373\341\356\360">
                                       8
     ?<Constant "\303\356\362\356\342 \341\356\353\
                                      16
     ?<Constant "\315\340\347\340\344">
                                       8
     ?<Constant "Save!">               8
     ?<Constant "">                    1
     ?<Constant "X-\321\362\340\362\363\361">
                                      12
     ?<Constant "\322\345\352\361\362">
                                       8
     ?<Constant "\321\354\345\355\350\362\374 X-\36
                                      20
     ?<Constant "\312\356\354\354\345\355\362\340\3
                                      40
     ?<Constant "Short XS %d">        24
     ?<Constant "\302 \361\345\362\350">
                                       8
     ?<Constant "\316\362\356\370\270\353">
                                       8
     ?<Constant "\315\345\344\356\361\362\363\357\3
                                      12
     ?<Constant "\315\345 \341\345\361\357\356\352\
                                      16
     ?<Constant "\307\340\355\377\362">
                                       8
     ?<Constant "\315\345\342\350\344\350\354\373\3
                                      12
     ?<Constant "\304\345\357\360\345\361\361\350\3
                                      12
     ?<Constant "\307\353\356\351">    8
      Others                         176

 
 4 124 bytes in segment CODE
   541 bytes in segment DATA_C
   116 bytes in segment DATA_I
   116 bytes in segment DATA_ID
     4 bytes in segment DATA_Z
    24 bytes in segment INITTAB
 
 3 972 bytes of CODE  memory (+ 176 bytes shared)
   657 bytes of CONST memory
   120 bytes of DATA  memory

Errors: none
Warnings: none
