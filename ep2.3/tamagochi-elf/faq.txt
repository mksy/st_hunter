FAQ по самосто€тельной сборке эльфов

1. —качиваем урезанную до минимально необходимого размера (9,44 ћб) версию —и компил€тора IAR УARM_Embedded_WorkbenchФ и устанавливаем, распаковав архив в выбранную папку. 
URL: http://allsiemens.com/soft/other/ARM_Embedded_Workbench.rar 

2. —качиваем клиента УTortoiseSVNФ (8,78 ћб), устанавливаем. 
URL: http://heanet.dl.sourceforge.net/sourcef....4.3.msi 

3. ¬ браузере (например, IE) заходим по адресу svn://cbsie.dyndns.info. ќткрываетс€ окошко УRepository BrowserФ. 
*  ликаем на папку svn://cbsie.dyndns.info. “ам исходники многих эльфов. 
* ¬ыбираем папку ARM, заходим. 
* ѕервым делом выбираем папки \inc и \SerialLib, так как они необходимы дл€ компилировани€ эльфов.  лика€ правой кнопкой мыши на папке, выбираем УExportЕФ. ¬ окошке УTortoiseSVN ExportЕФ выбираем УRevision: HEAD revisionФ (головна€, сама€ свежа€), сохран€ем у себ€ на компьютере. ƒл€ SerialLib дл€ удобства сразу прописываем путь C:\SerialLib, так как именно такой путь указан в исходниках многих эльфов. 
* —одержимое папки \inc с SVN копируем в папку \inc ARM_Embedded_Workbench. 
* “акже скачиваем утилиту У_SVN_UtilityФ, котора€ может оказатьс€ полезной дл€ автоматической подстановки номера ревизии в проект при компил€ции. 

4. ¬ыбираем папку понравившегос€ эльфа, однако не стоит сразу копировать ее к себе на компьютер. Ќекоторые ревизии кода предназначены дл€ версий эльфпака, на которые еще не было официального релиза.  лика€ правой кнопкой мыши на папке, выбираем УShow logФ. ¬нимательно читаем историю изменений. ¬ыбираем самую свежую версию (Revision), совместимую с ¬ашим эльфпаком, скачиваем, €вно указав в опци€х при экспорте номер ревизии. 

5. “еперь уже можно пробовать собирать эльфов дл€ вашего телефона. ќднако некоторые из них будут требовать файлы, которые отсутствуют в скачанной УARM_Embedded_WorkbenchФ. ѕоэтому тренировку лучше всего начать со сборки SerialLib, после которой по€витс€ многое, необходимое дл€ сборки других эльфов. 
* «апускаем IAR (Е\ARM_Embedded_Workbench\Embedded Workbench 4.0 Evaluation\common\bin\IarIdePM), кликаем УOpen existing WorkspaceФ, кликаем SerialLib.eww. (»ли в папке C:\SerialLib кликаем дважды на SerialLib IAR IDE Workspace (если IAR Embedded_Workbench IDE не запускаетс€ автоматически, вручную указываем путь к приложению)). 
* ¬ УProjectФ->ФEdit ConfigurationsЕФ выбираем УReleaseФ, т.к. скомпилированные с Debug эльфы не загруз€тс€! 
* ¬ УProjectФ->ФOptionsФ->ФGeneral OptionsФ выбираем УProcessor variant: ARM926EJ-SФ, УProcessor mode: ArmФ. 
* “еперь выбираем УProjectФ->ФRebuild AllФ. 
¬ нижней части экрана смотрим сообщение об успешной компил€ции проекта. 
* “еперь скомпилируем собственно эльфа SerialTest. ¬ окошке в выпадающем списке УWorkspaceФ выбираем УSerialTest-ReleaseФ, и снова УProjectФ->ФRebuild AllФ. 
ѕосле запуска программы УIARФ и выбора УProjectФ->ФRebuild AllФ в папке проекта создаютс€ дополнительные папки \Settings и \Release. ¬ \Release наход€тс€ три папки \Exe, \List и \Obj. ¬ папку \Exe при успешной компил€ции помещаетс€ готовый эльф. 

6. ѕо описанной методике приступаем к сборке выбранного ¬ами эльфа. 
≈сли в проекте присутствуют два файла XXX.eww и XXX_IAR_old.eww, открываем XXX.eww. —компилированные с XXX_IAR_old.eww эльфы создают .bcfg нулевого размера. 
≈сли у ¬ас телефон E/El71, то в УProjectФ->ФEdit ConfigurationsЕФ выбираем УRelease_ELKAФ. ≈сли такой опции нет, можно попробовать выбрать другой вариант, вдруг да заработает. 
≈сли в проекте присутствует файл revision.h, но нет желани€ настраивать утилиту getsvn, пропишите в файле revision.h строку #define __SVN_REVISION__ 000, где 000 замените на номер ревизии. ≈сли при компил€ции программа требует наличи€ файла revision.h, а в проекте его нет, запустите приложение getsvn в папке _SVN_Utility, по€вившийс€ файл revision.h скопируйте в папку с файлами проекта. 

7. —ообщени€ об ошибках и пути решени€ 

¬опрос: что значит " #include "..\..\swilib.h" " и почему на нЄм выдаЄтс€ ошибка? 
ќтвет: "..\..\" это относительный путь. ќзначает, что файл лежит на два уровн€ ниже текущей директории. ≈сли стереть, то должно получитьс€ #include "swilib.h", тогда swilib будет братьс€ из директории, где установлен IAR\ARM\INC. ћожно еще написать #include ".\swilib.h", тогда swilib будет братьс€ из папки, где лежит проект. 

¬опрос: что это за ошибка УFatal Error[e72]: Segment ELFBEGIN must be defined in a segment definition option (-Z, -b or -P)Ф? 
ќтвет: в IAR'е заходишь Project->Options->Linker->Config. “ам в Linker command file ставишь галочку Override default, жмешь на многоточие справа и выбираешь из папки, где лежит твой проект, файл test.xlc. 

¬опрос: все примеры компилируютс€ нормально, но они все вырубают мобилу. 
ќтвет: в настройках линкера какой *.xcl указан? Ќадо тот, который в папке с исходниками лежит, а не тот, который с IAR идет. ƒа, кстати, когда проект открываешь, необходимо заново прописывать xcl файл. 

¬опрос: эльф получаетс€, но при запуске создаЄтс€ нулевой (пустой) файл *.bcfg. ¬ чЄм проблема? 
ќтвет: проверь им€ сегмента дл€ файла config_data.c в проекте: правой мышью по имени файла в дереве проекта - Options, должно сто€ть Override inherited settings, на вкладке Output в Segment base name - им€ сегмента CONFIG (а не DATA и CODE). 

¬опрос: достала ошибка: "_thumb functions can only call_swi functions with swi_number in range 0-0xFF".  ак ее исправить? 
ќтвет: в опци€х надо выбрать ARM,а не тумбу. 

¬опрос: УFatal Error[e136]: The output format 'debug' does not support the use of relocation areas (-V option). Did you forget a format modifier flag?Ф „то делать? 
ќтвет: ну сколько говорить, что дл€ компил€ции любого проекта необходимо ставить конфигурацию Release, а не Debug. 

¬опрос: у кого-нибудь есть такой файл obexcopy.exe? ј то у мен€ выдает ошибку, что нет такого файла. 
ќтвет: этот файл не €вл€етс€ об€зательным дл€ компил€ции проекта, это скорее дл€ удобства. „тобы не выдавала ошибку, идешь по след пути: Project-Options, выбираешь пункт Build Actions и удал€ешь все из полей Pre-buid и Post-build command line. 

¬опрос: IAR пишет, что не найдены div_32a, div_64a, doubleToLong, float. 
ќтвет: ¬ меню Project->Options->Library Configuration выбрать Normal. Ќужные библиотеки подключатс€ автоматически.